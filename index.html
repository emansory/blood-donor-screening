<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blood Donor Screening - Saudi National Blood Bank</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone@7.23.5/babel.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useMemo } = React;

// Simple icon components using emoji
const Search = (p) => <span className={p.className} style={{display:'inline-flex'}}>ğŸ”</span>;
const ChevronRight = (p) => <span className={p.className} style={{display:'inline-flex',transition:'transform 0.2s'}}>Ã¢â€“Â¶</span>;
const ChevronLeft = (p) => <span className={p.className} style={{display:'inline-flex'}}>Ã¢â€”â‚¬</span>;
const Check = (p) => <span className={p.className} style={{display:'inline-flex'}}>âœ“</span>;
const X = (p) => <span className={p.className} style={{display:'inline-flex'}}>âœ—</span>;
const AlertTriangle = (p) => <span className={p.className} style={{display:'inline-flex'}}>âš ï¸</span>;
const Clock = (p) => <span className={p.className} style={{display:'inline-flex'}}>â±ï¸</span>;
const FileText = (p) => <span className={p.className} style={{display:'inline-flex'}}>ğŸ“„</span>;
const Database = (p) => <span className={p.className} style={{display:'inline-flex'}}>ğŸ—ƒï¸</span>;
const Heart = (p) => <span className={p.className} style={{display:'inline-flex'}}>â¤ï¸</span>;
const Globe = (p) => <span className={p.className} style={{display:'inline-flex'}}>ğŸŒ</span>;
const Filter = (p) => <span className={p.className} style={{display:'inline-flex'}}>ğŸ”½</span>;
const RefreshCw = (p) => <span className={p.className} style={{display:'inline-flex'}}>ğŸ”„</span>;
const Info = (p) => <span className={p.className} style={{display:'inline-flex'}}>â„¹ï¸</span>;
const Calendar = (p) => <span className={p.className} style={{display:'inline-flex'}}>ğŸ“…</span>;
const ExternalLink = (p) => <span className={p.className} style={{display:'inline-flex'}}>â†—ï¸</span>;

// React loaded via CDN
// Icons loaded via CDN

const RULES_DATA = {"metadata": {"title": "Saudi Blood Donor Eligibility Rules Database", "version": "1.1", "version_date": "2026-01-02T16:44:47.753334", "based_on": "Saudi National DHQ v1.0 (2025)", "source_documents": ["Questionnaire_001.docx - Donor History Questionnaire", "Manual_003.docx - Instructions for blood bank staff", "medication_list_002.docx - Medication Deferral List"], "total_rules": 139, "revision_notes": "Version 1.1 includes: Added missing medications (Dalteparin, Edoxaban), added reference URLs, fixed Q1 logic, added followup questions for Q5, Q6, Q51, added TRALI notes, added sexual contact definitions"}, "rules": [{"question_number": "REQ-1", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Age â‰¥18 years (17-18 with parental consent)", "question_text_ar": "Ø£Ù„Ø§ ÙŠÙ‚Ù„ Ø§Ù„Ø¹Ù…Ø± Ø¹Ù† Ù¡Ù¨ Ø¹Ø§Ù…Ø§Ù‹", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "all", "rule_id": "R001"}, {"question_number": "REQ-2", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Valid Saudi ID or Iqama", "question_text_ar": "Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø© Ø³Ø§Ø±ÙŠØ©", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "all", "rule_id": "R002"}, {"question_number": "REQ-3", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Understands Arabic or English", "question_text_ar": "ÙÙ‡Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "all", "rule_id": "R003"}, {"question_number": "REQ-4", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Hgb â‰¥13, Hct â‰¥39% (males)", "question_text_ar": "Ù‡ÙŠÙ…ÙˆØ¬Ù„ÙˆØ¨ÙŠÙ† â‰¥Ù¡Ù£ØŒ Ù‡ÙŠÙ…Ø§ØªÙˆÙƒØ±ÙŠØª â‰¥Ù£Ù©Ùª", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "male", "rule_id": "R004"}, {"question_number": "REQ-5", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Hgb â‰¥12.5, Hct â‰¥38% (females)", "question_text_ar": "Ù‡ÙŠÙ…ÙˆØ¬Ù„ÙˆØ¨ÙŠÙ† â‰¥Ù¡Ù¢.Ù¥ØŒ Ù‡ÙŠÙ…Ø§ØªÙˆÙƒØ±ÙŠØª â‰¥Ù£Ù¨Ùª", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "female", "rule_id": "R005"}, {"question_number": "REQ-6", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Ferritin â‰¥30 if 4+ donations/year", "question_text_ar": "ÙÙŠØ±ÙŠØªÙŠÙ† â‰¥Ù£Ù  Ø¥Ø°Ø§ Ã™Â¤+ ØªØ¨Ø±Ø¹Ø§Øª/Ø³Ù†Ø©", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "all", "rule_id": "R006"}, {"question_number": "REQ-7", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Temperature â‰¤37.5Â°C oral", "question_text_ar": "Ø§Ù„Ø­Ø±Ø§Ø±Ø© â‰¤Ã™Â£Ã™Â§.Ã™Â¥ Ø¯Ø±Ø¬Ø©", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "all", "rule_id": "R007"}, {"question_number": "REQ-8", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "BP: Sys 90-180, Dia 50-100", "question_text_ar": "Ø§Ù„Ø¶ØºØ·: Ø§Ù†Ù‚Ø¨Ø§Ø¶ÙŠ Ù©Ù -Ù¡Ù¨Ù ØŒ Ø§Ù†Ø¨Ø³Ø§Ø·ÙŠ Ù¥Ù -Ù¡Ù Ù ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "all", "rule_id": "R008"}, {"question_number": "REQ-9", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Pulse 50-100 bpm, regular", "question_text_ar": "Ø§Ù„Ù†Ø¨Ø¶ Ù¥Ù -Ù¡Ù Ù ØŒ Ù…Ù†ØªØ¸Ù…", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "all", "rule_id": "R009"}, {"question_number": "REQ-10", "parent_rule_id": null, "node_type": "requirement", "is_followup": false, "trigger_answer": null, "question_text_en": "Weight â‰¥50 kg", "question_text_ar": "Ø§Ù„ÙˆØ²Ù† â‰¥Ù¥Ù  ÙƒØ¬Ù…", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "DEFER", "next_if_yes": null, "next_if_no": null, "rationale_en": "Basic eligibility requirement", "category": "general_eligibility", "applies_to": "all", "rule_id": "R010"}, {"question_number": "Q1", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Are you feeling healthy and well to donate blood today?", "question_text_ar": "Ù‡Ù„ ØªØ´Ø¹Ø± Ø£Ù†Ùƒ Ø¨ØµØ­Ø© Ø¬ÙŠØ¯Ø© Ù„Ù„ØªØ¨Ø±Ø¹ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CONTINUE_SCREENING", "outcome_if_no": "EVALUATE_UNDERLYING_CONDITION", "next_if_yes": "Q2", "next_if_no": null, "rationale_en": "Assessment for general_health", "category": "general_health", "applies_to": "all", "rule_id": "R011"}, {"question_number": "Q2", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you read the blood donor educational materials today?", "question_text_ar": "Ù‡Ù„ Ø§Ø·Ù„Ø¹Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØªØ«Ù‚ÙŠÙÙŠØ©ØŸ", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Assessment for general_health", "category": "general_health", "applies_to": "all", "rule_id": "R012"}, {"question_number": "Q3", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you ever been refused as a blood donor?", "question_text_ar": "Ù‡Ù„ Ø³Ø¨Ù‚ Ù…Ù†Ø¹Ùƒ Ù…Ù† Ø§Ù„ØªØ¨Ø±Ø¹ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "EVALUATE", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Assessment for general_health", "category": "general_health", "applies_to": "all", "rule_id": "R013"}, {"question_number": "Q4", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you been to the dentist for a procedure in the past 7 days?", "question_text_ar": "Ù‡Ù„ Ø²Ø±Øª Ø·Ø¨ÙŠØ¨ Ø§Ù„Ø£Ø³Ù†Ø§Ù† Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ã™Â§ Ø£ÙŠØ§Ù…ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CHECK_PROCEDURE_TYPE", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q4.1", "next_if_no": "Q5", "rationale_en": "Deferral depends on procedure invasiveness", "category": "dental", "applies_to": "all", "rule_id": "R014"}, {"question_number": "Q4.1a", "parent_rule_id": "R014", "node_type": "followup_option", "is_followup": true, "trigger_answer": "YES", "question_text_en": "No deferral: Ortho wire adjustment, Fluoride, Superficial cleaning, Appliance delivery", "question_text_ar": "Ø¨Ø¯ÙˆÙ† ØªØ£Ø¬ÙŠÙ„: ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…ØŒ Ø§Ù„ÙÙ„ÙˆØ±Ø§ÙŠØ¯ØŒ Ø§Ù„ØªÙ†Ø¸ÙŠÙ", "deferral_type": "none", "deferral_duration": 0, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": "Q5", "next_if_no": null, "rationale_en": "Non-invasive procedures", "category": "dental", "applies_to": "all", "rule_id": "R015"}, {"question_number": "Q4.1b", "parent_rule_id": "R014", "node_type": "followup_option", "is_followup": true, "trigger_answer": "YES", "question_text_en": "24-hour deferral: Ortho band, Restorative/fillings, Simple root canal, Crown/bridge prep, Other non-surgical", "question_text_ar": "ØªØ£Ø¬ÙŠÙ„ Ù¢Ù¤ Ø³Ø§Ø¹Ø©: Ø­Ù„Ù‚Ø§Øª Ø§Ù„ØªÙ‚ÙˆÙŠÙ…ØŒ Ø­Ø´ÙˆØ§ØªØŒ Ø¹Ù„Ø§Ø¬ Ø¹ØµØ¨ Ø¨Ø³ÙŠØ·", "deferral_type": "temporary", "deferral_duration": 24, "deferral_unit": "hours", "outcome_if_yes": "DEFER_24H", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Minor invasive procedures", "category": "dental", "applies_to": "all", "rule_id": "R016"}, {"question_number": "Q4.1c", "parent_rule_id": "R014", "node_type": "followup_option", "is_followup": true, "trigger_answer": "YES", "question_text_en": "7-day deferral: Extractions, Biopsy, Surgical root canal, Dental implant, Surgical procedures", "question_text_ar": "ØªØ£Ø¬ÙŠÙ„ Ã™Â§ Ø£ÙŠØ§Ù…: Ø®Ù„Ø¹ØŒ Ø®Ø²Ø¹Ø©ØŒ Ø²Ø±Ø§Ø¹Ø©ØŒ Ø¬Ø±Ø§Ø­Ø§Øª", "deferral_type": "temporary", "deferral_duration": 7, "deferral_unit": "days", "outcome_if_yes": "DEFER_7D", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Surgical/invasive procedures", "category": "dental", "applies_to": "all", "rule_id": "R017"}, {"question_number": "Q5", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you had a wound or skin infection in the past 2 weeks?", "question_text_ar": "Ù‡Ù„ Ø£ØµØ¨Øª Ø¨Ø¬Ø±Ø­ Ø£Ùˆ Ø§Ù„ØªÙ‡Ø§Ø¨ Ø¬Ù„Ø¯ÙŠ Ø®Ù„Ø§Ù„ Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†ØŸ", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "weeks", "outcome_if_yes": "CHECK_ANTIBIOTIC_USE", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q5.1", "next_if_no": "Q6", "rationale_en": "2 weeks after healing; 4 weeks if antibiotics used", "category": "general_health", "applies_to": "all", "rule_id": "R018"}, {"question_number": "Q6", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had any type of cancer, including leukemia?", "question_text_ar": "Ù‡Ù„ Ø´ÙØ®ØµØª Ø¨Ø£ÙŠ Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø³Ø±Ø·Ø§Ù†ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "EVALUATE_PER_SOP", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q6.1", "next_if_no": "Q7", "rationale_en": "Hematological=permanent; Others=12 months if cancer-free", "category": "medical_history", "applies_to": "all", "rule_id": "R019"}, {"question_number": "Q6.1", "parent_rule_id": "R019", "node_type": "followup_decision", "is_followup": true, "trigger_answer": "YES", "question_text_en": "Is/was the cancer hematological (blood cancer like leukemia, lymphoma, myeloma)?", "question_text_ar": "Ù‡Ù„ Ø§Ù„Ø³Ø±Ø·Ø§Ù† Ø¯Ù…ÙˆÙŠ (Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø¯Ù…ØŒ Ù„ÙŠÙ…ÙÙˆÙ…Ø§ØŒ ÙˆØ±Ù… Ù†Ù‚ÙˆÙŠ)Ã˜Å¸", "deferral_type": "variable", "deferral_duration": 12, "deferral_unit": "months", "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "CHECK_TREATMENT_STATUS", "next_if_yes": null, "next_if_no": "Q6.2", "rationale_en": "Based on cancer type and treatment status", "category": "medical_history", "applies_to": "all", "rule_id": "R020"}, {"question_number": "Q7", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had any problems with your heart or lungs?", "question_text_ar": "Ù‡Ù„ Ø´ÙØ®ØµØª Ø¨Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ù‚Ù„Ø¨ Ø£Ùˆ Ø§Ù„Ø±Ø¦ØªÙŠÙ†ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "EVALUATE_PER_SOP", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q8", "rationale_en": "Per physician judgment", "category": "medical_history", "applies_to": "all", "rule_id": "R021"}, {"question_number": "Q8", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you ever had a bleeding condition or blood disease?", "question_text_ar": "Ù‡Ù„ Ø´ÙØ®ØµØª Ø¨Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ø¯Ù… Ø£Ùˆ Ù…Ø±Ø¶ Ø¯Ù…ÙˆÙŠØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_INDEFINITE", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q9", "rationale_en": "Hemophilia/clotting deficiency = permanent (donor safety)", "category": "medical_history", "applies_to": "all", "rule_id": "R022"}, {"question_number": "Q9", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Do you have diabetes?", "question_text_ar": "Ù‡Ù„ Ø£Ù†Øª Ù…ØµØ§Ø¨ Ø¨Ø§Ù„Ø³ÙƒØ±ÙŠØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CONTINUE_Q9.1", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q9.1", "next_if_no": "Q10", "rationale_en": "Additional assessment for severity", "category": "diabetes", "applies_to": "all", "rule_id": "R023"}, {"question_number": "Q9.1", "parent_rule_id": "R023", "node_type": "followup_question", "is_followup": true, "trigger_answer": "YES", "question_text_en": "Do you have dizziness when standing, or ulcers on foot/leg?", "question_text_ar": "Ù‡Ù„ ØªØ¹Ø§Ù†ÙŠ Ù…Ù† Ø¯ÙˆØ®Ø© Ø¹Ù†Ø¯ Ø§Ù„ÙˆÙ‚ÙˆÙ Ø£Ùˆ ØªÙ‚Ø±Ø­Ø§Øª ÙÙŠ Ù‚Ø¯Ù…ÙƒØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "CONTINUE_Q9.2", "next_if_yes": null, "next_if_no": "Q9.2", "rationale_en": "Diabetic complications = permanent deferral", "category": "diabetes", "applies_to": "all", "rule_id": "R024"}, {"question_number": "Q9.2", "parent_rule_id": "R023", "node_type": "followup_question", "is_followup": true, "trigger_answer": "NO_Q9.1", "question_text_en": "Acute episode in past 3 months (needed help or ER visit)?", "question_text_ar": "Ù†ÙˆØ¨Ø© Ø­Ø§Ø¯Ø© ÙÙŠ Ø¢Ø®Ø± Ã™Â£ Ø£Ø´Ù‡Ø± (Ø§Ø­ØªØ¬Øª Ù…Ø³Ø§Ø¹Ø¯Ø© Ø£Ùˆ Ø·ÙˆØ§Ø±Ø¦)Ã˜Å¸", "deferral_type": "temporary", "deferral_duration": 3, "deferral_unit": "months", "outcome_if_yes": "DEFER_3_MONTHS", "outcome_if_no": "CONTINUE_Q9.3", "next_if_yes": null, "next_if_no": "Q9.3", "rationale_en": "Recent acute episode = 3 month deferral", "category": "diabetes", "applies_to": "all", "rule_id": "R025"}, {"question_number": "Q9.3", "parent_rule_id": "R023", "node_type": "followup_question", "is_followup": true, "trigger_answer": "NO_Q9.2", "question_text_en": "Have you eaten in the past 2 hours?", "question_text_ar": "Ù‡Ù„ ØªÙ†Ø§ÙˆÙ„Øª Ø§Ù„Ø·Ø¹Ø§Ù… Ø®Ù„Ø§Ù„ Ø³Ø§Ø¹ØªÙŠÙ†ØŸ", "deferral_type": "action_required", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "ASK_TO_EAT", "next_if_yes": "Q10", "next_if_no": null, "rationale_en": "Prevent hypoglycemia during donation", "category": "diabetes", "applies_to": "all", "rule_id": "R026"}, {"question_number": "Q10", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "For women only: Are you pregnant now?", "question_text_ar": "Ù„Ù„Ø³ÙŠØ¯Ø§Øª: Ù‡Ù„ Ø£Ù†ØªÙ Ø­Ø§Ù…Ù„ Ø§Ù„Ø¢Ù†ØŸ", "deferral_type": "temporary", "deferral_duration": 9, "deferral_unit": "months", "outcome_if_yes": "DEFER_9M_AFTER_PREGNANCY_END", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q11", "rationale_en": "9 months after pregnancy end", "category": "pregnancy", "applies_to": "female", "rule_id": "R027", "reference_urls": {"url": "https://www.who.int/campaigns/world-blood-donor-day/2019/who-can-give-blood", "source": "WHO"}}, {"question_number": "Q11", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "For women only: Have you EVER been pregnant?", "question_text_ar": "Ù„Ù„Ø³ÙŠØ¯Ø§Øª: Ù‡Ù„ Ø³Ø¨Ù‚ Ù„Ùƒ Ø§Ù„Ø­Ù…Ù„ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CONTINUE_Q11.1", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q11.1", "next_if_no": "Q12", "rationale_en": "Assess recency (9 months post-pregnancy) and TRALI risk. Female donors with previous pregnancies may develop antibodies causing transfusion-related acute lung injury (TRALI). SOPs should include TRALI risk mitigation strategy.", "category": "pregnancy", "applies_to": "female", "rule_id": "R028", "reference_urls": {"url": "https://www.who.int/campaigns/world-blood-donor-day/2019/who-can-give-blood", "source": "WHO"}, "trali_note": "Multiparous donors (those with previous pregnancies) are at risk for developing HLA antibodies that can cause TRALI in recipients. Blood establishments should have TRALI mitigation policies."}, {"question_number": "Q11.1", "parent_rule_id": "R028", "node_type": "followup_question", "is_followup": true, "trigger_answer": "YES", "question_text_en": "Have you been pregnant in the past 9 months?", "question_text_ar": "Ù‡Ù„ ÙƒÙ†ØªÙ Ø­Ø§Ù…Ù„Ø§Ù‹ Ø®Ù„Ø§Ù„ Ã™Â© Ø£Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠØ©ØŸ", "deferral_type": "temporary", "deferral_duration": 9, "deferral_unit": "months", "outcome_if_yes": "CONTINUE_Q11.2", "outcome_if_no": "TRALI_RESTRICTION", "next_if_yes": "Q11.2", "next_if_no": "Q12", "rationale_en": "Recent pregnancy check + TRALI for past pregnancies", "category": "pregnancy", "applies_to": "female", "rule_id": "R029"}, {"question_number": "Q11.2", "parent_rule_id": "R028", "node_type": "followup_question", "is_followup": true, "trigger_answer": "YES_Q11.1", "question_text_en": "Are you breastfeeding?", "question_text_ar": "Ù‡Ù„ ØªØ±Ø¶Ø¹ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹ØŸ", "deferral_type": "temporary", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_DURING_BF", "outcome_if_no": "DEFER_9M_FROM_PREGNANCY_END", "next_if_yes": null, "next_if_no": null, "rationale_en": "Defer during breastfeeding", "category": "pregnancy", "applies_to": "female", "rule_id": "R030"}, {"question_number": "Q12", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Are you currently taking any medications?", "question_text_ar": "Ù‡Ù„ ØªØ³ØªØ®Ø¯Ù… Ø£ÙŠ Ø£Ø¯ÙˆÙŠØ© Ø­Ø§Ù„ÙŠØ§Ù‹ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "EVALUATE_REASON", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q13", "next_if_no": "Q13", "rationale_en": "Evaluate reason for medication", "category": "medications", "applies_to": "all", "rule_id": "R031"}, {"question_number": "Q13", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you taken any medications on the Medication Deferral List?", "question_text_ar": "Ù‡Ù„ Ø§Ø³ØªØ®Ø¯Ù…Øª Ø£Ø¯ÙˆÙŠØ© Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ£Ø¬ÙŠÙ„ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CHECK_SPECIFIC_MED", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q14", "rationale_en": "Specific deferrals per medication", "category": "medications", "applies_to": "all", "rule_id": "R032", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M01", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Antibiotics/antivirals/antifungals", "question_text_ar": "Ø§Ù„Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„Ø­ÙŠÙˆÙŠØ©", "deferral_type": "temporary", "deferral_duration": 1, "deferral_unit": "months", "outcome_if_yes": "DEFER_1_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R033", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M02", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Aspirin", "question_text_ar": "Ø£Ø³Ø¨Ø±ÙŠÙ†", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R034", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M03", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Piroxicam (Feldene)", "question_text_ar": "ÙÙŠÙ„Ø¯ÙŠÙ†", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R035", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M04", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Prasugrel (Effient)", "question_text_ar": "Ø¥ÙŠÙÙŠÙ†Øª", "deferral_type": "temporary", "deferral_duration": 3, "deferral_unit": "days", "outcome_if_yes": "DEFER_3_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R036", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M05", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Ticagrelor (Brilinta)", "question_text_ar": "Ø¨Ø±ÙŠÙ„ÙŠÙ†ØªØ§", "deferral_type": "temporary", "deferral_duration": 7, "deferral_unit": "days", "outcome_if_yes": "DEFER_7_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R037", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M06", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Clopidogrel (Plavix)", "question_text_ar": "Ø¨Ù„Ø§ÙÙŠÙƒØ³", "deferral_type": "temporary", "deferral_duration": 14, "deferral_unit": "days", "outcome_if_yes": "DEFER_14_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R038", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M07", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Ticlopidine (Ticlid)", "question_text_ar": "ØªÙŠÙƒÙ„ÙŠØ¯", "deferral_type": "temporary", "deferral_duration": 14, "deferral_unit": "days", "outcome_if_yes": "DEFER_14_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R039", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M08", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Vorapaxar (Zontivity)", "question_text_ar": "Ø²ÙˆÙ†ØªÙŠÙÙŠØªÙŠ", "deferral_type": "temporary", "deferral_duration": 1, "deferral_unit": "months", "outcome_if_yes": "DEFER_1_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R040", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M09", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Fondaparinux (Arixtra)", "question_text_ar": "Ø£Ø±ÙŠÙƒØ³ØªØ±Ø§", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R041", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M10", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Apixaban (Eliquis)", "question_text_ar": "Ø¥Ù„ÙŠÙƒÙˆÙŠØ³", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R042", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M11", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Enoxaparin (Lovenox)", "question_text_ar": "Ù„ÙˆÙÙŠÙ†ÙˆÙƒØ³", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R043", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M12", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Dabigatran (Pradaxa)", "question_text_ar": "Ø¨Ø±Ø§Ø¯Ø§ÙƒØ³Ø§", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R044", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M13", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Rivaroxaban (Xarelto)", "question_text_ar": "Ø²Ø§Ø±ÙŠÙ„ØªÙˆ", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R045", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M14", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Warfarin (Coumadin)", "question_text_ar": "ÙƒÙˆÙ…Ø§Ø¯ÙŠÙ†", "deferral_type": "temporary", "deferral_duration": 7, "deferral_unit": "days", "outcome_if_yes": "DEFER_7_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R046", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M15", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Heparin/LMWH", "question_text_ar": "Ø§Ù„Ù‡ÙŠØ¨Ø§Ø±ÙŠÙ†", "deferral_type": "temporary", "deferral_duration": 7, "deferral_unit": "days", "outcome_if_yes": "DEFER_7_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R047", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M16", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Isotretinoin (Accutane/Roaccutane)", "question_text_ar": "Ø±ÙˆØ£ÙƒÙŠÙˆØªØ§Ù†", "deferral_type": "temporary", "deferral_duration": 1, "deferral_unit": "months", "outcome_if_yes": "DEFER_1_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R048", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M17", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Finasteride (Propecia/Proscar)", "question_text_ar": "Ø¨Ø±ÙˆØ¨ÙŠØ´ÙŠØ§/Ø¨Ø±ÙˆØ³ÙƒØ§Ø±", "deferral_type": "temporary", "deferral_duration": 1, "deferral_unit": "months", "outcome_if_yes": "DEFER_1_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R049", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M18", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Dutasteride (Avodart)", "question_text_ar": "Ø£ÙÙˆØ¯Ø§Ø±Øª", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R050", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M19", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Acitretin (Soriatane)", "question_text_ar": "Ø³ÙˆØ±ÙŠØ§ØªØ§Ù†", "deferral_type": "temporary", "deferral_duration": 36, "deferral_unit": "months", "outcome_if_yes": "DEFER_36_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R051", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M20", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Etretinate (Tegison)", "question_text_ar": "ØªÙŠØ¬ÙŠØ³ÙˆÙ†", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R052", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M21", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Thalidomide/Lenalidomide", "question_text_ar": "Ø«Ø§Ù„ÙˆÙ…ÙŠØ¯/Ø±ÙŠÙÙ„ÙŠÙ…ÙŠØ¯", "deferral_type": "temporary", "deferral_duration": 1, "deferral_unit": "months", "outcome_if_yes": "DEFER_1_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R053", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M22", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Teriflunomide (Aubagio)", "question_text_ar": "Ø£ÙˆØ¨Ø§Ø¬ÙŠÙˆ", "deferral_type": "temporary", "deferral_duration": 24, "deferral_unit": "months", "outcome_if_yes": "DEFER_24_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R054", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M23", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Leflunomide (Arava)", "question_text_ar": "Ø£Ø±Ø§ÙØ§", "deferral_type": "temporary", "deferral_duration": 24, "deferral_unit": "months", "outcome_if_yes": "DEFER_24_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R055", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M24", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Mycophenolate (Cellcept)", "question_text_ar": "Ø³ÙŠÙ„Ø³ÙŠØ¨Øª", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "weeks", "outcome_if_yes": "DEFER_6_WEEKS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R056", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M25", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Upadacitinib (Rinvoq)", "question_text_ar": "Ø±ÙŠÙ†ÙÙˆÙƒ", "deferral_type": "temporary", "deferral_duration": 1, "deferral_unit": "months", "outcome_if_yes": "DEFER_1_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R057", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M26", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Vismodegib (Erivedge)", "question_text_ar": "Ø¥ÙŠØ±ÙŠÙÙŠØ¯Ø¬", "deferral_type": "temporary", "deferral_duration": 24, "deferral_unit": "months", "outcome_if_yes": "DEFER_24_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R058", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M27", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Sonidegib (Odomzo)", "question_text_ar": "Ø£ÙˆØ¯ÙˆÙ…Ø²Ùˆ", "deferral_type": "temporary", "deferral_duration": 24, "deferral_unit": "months", "outcome_if_yes": "DEFER_24_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R059", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M28", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Oral PrEP/PEP (Truvada, etc)", "question_text_ar": "Ø£Ø¯ÙˆÙŠØ© Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø¥ÙŠØ¯Ø² Ø§Ù„ÙÙ…ÙˆÙŠØ©", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R060", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M29", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Injectable PrEP (Cabotegravir)", "question_text_ar": "Ø£Ø¯ÙˆÙŠØ© Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ø¨Ø§Ù„Ø­Ù‚Ù†", "deferral_type": "temporary", "deferral_duration": 24, "deferral_unit": "months", "outcome_if_yes": "DEFER_24_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R061", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M30", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "ART (HIV treatment)", "question_text_ar": "Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø¥ÙŠØ¯Ø²", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R062", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M31", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "HBIG (Hepatitis B Immune Globulin)", "question_text_ar": "Ø§Ù„Ø£Ø¬Ø³Ø§Ù… Ø§Ù„Ù…Ø¶Ø§Ø¯Ø© Ù„Ù„ÙƒØ¨Ø¯ Ø¨", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R063", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M32", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Experimental medications/vaccines", "question_text_ar": "Ø£Ø¯ÙˆÙŠØ©/Ù„Ù‚Ø§Ø­Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©", "deferral_type": "temporary", "deferral_duration": 12, "deferral_unit": "months", "outcome_if_yes": "DEFER_12_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Medication-specific deferral", "category": "medications", "applies_to": "all", "rule_id": "R064", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q14", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In the past 8 weeks, have you had any vaccinations?", "question_text_ar": "Ù‡Ù„ ØªÙ„Ù‚ÙŠØª Ù„Ù‚Ø§Ø­Ø§Øª Ø®Ù„Ø§Ù„ Ã™Â¨ Ø£Ø³Ø§Ø¨ÙŠØ¹ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CHECK_VACCINE_TYPE", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q14.1", "next_if_no": "Q15", "rationale_en": "Deferral depends on vaccine type", "category": "vaccinations", "applies_to": "all", "rule_id": "R065", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V01", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "Live attenuated (Rubella, Varicella)", "question_text_ar": "Ø­ÙŠØ© Ù…Ø¶Ø¹ÙØ© (Ø§Ù„Ø­ØµØ¨Ø© Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ©ØŒ Ø§Ù„Ø¬Ø¯Ø±ÙŠ Ø§Ù„Ù…Ø§Ø¦ÙŠ)", "deferral_type": "temporary", "deferral_duration": 4, "deferral_unit": "weeks", "outcome_if_yes": "DEFER_4_WEEKS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R066", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V02", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "Live attenuated (Measles, Mumps, Polio oral, Typhoid oral, Yellow fever)", "question_text_ar": "Ø­ÙŠØ© Ù…Ø¶Ø¹ÙØ© (Ø§Ù„Ø­ØµØ¨Ø©ØŒ Ø§Ù„Ù†ÙƒØ§ÙØŒ Ø´Ù„Ù„ Ø£Ø·ÙØ§Ù„ ÙÙ…ÙˆÙŠ)", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "weeks", "outcome_if_yes": "DEFER_2_WEEKS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R067", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V03", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "Jynneos (Smallpox/Mpox - non-replicating)", "question_text_ar": "Ø¬ÙŠÙ†ÙŠÙˆØ³ (Ø§Ù„Ø¬Ø¯Ø±ÙŠ/Ø¬Ø¯Ø±ÙŠ Ø§Ù„Ù‚Ø±ÙˆØ¯ - ØºÙŠØ± Ù…ØªÙƒØ§Ø«Ø±)", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": "Q15", "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R068", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V04", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "Smallpox vaccinia (replication competent)", "question_text_ar": "Ø¬Ø¯Ø±ÙŠ ÙØ§ÙƒØ³ÙŠÙ†ÙŠØ§ (Ù…ØªÙƒØ§Ø«Ø±)", "deferral_type": "special", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "SPECIAL_ASSESSMENT", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R069", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V05", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "COVID-19 (non-replicating/mRNA)", "question_text_ar": "ÙƒÙˆÙÙŠØ¯-Ù¡Ù© (ØºÙŠØ± Ù…ØªÙƒØ§Ø«Ø±/mRNA)", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": "Q15", "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R070", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V06", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "COVID-19 (live attenuated)", "question_text_ar": "ÙƒÙˆÙÙŠØ¯-Ù¡Ù© (Ø­ÙŠ Ù…Ø¶Ø¹Ù)", "deferral_type": "temporary", "deferral_duration": 14, "deferral_unit": "days", "outcome_if_yes": "DEFER_14_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R071", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V07", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "COVID-19 (unknown type)", "question_text_ar": "ÙƒÙˆÙÙŠØ¯-Ù¡Ù© (Ù†ÙˆØ¹ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ)", "deferral_type": "temporary", "deferral_duration": 14, "deferral_unit": "days", "outcome_if_yes": "DEFER_14_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R072", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V08", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "Toxoids/killed vaccines (if symptom-free)", "question_text_ar": "Ø°ÙŠÙØ§Ù†Ø§Øª/Ù„Ù‚Ø§Ø­Ø§Øª Ù…ÙŠØªØ© (Ø¥Ø°Ø§ Ø®Ø§Ù„Ù Ù…Ù† Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶)", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": "Q15", "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R073", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V09", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "Recombinant vaccines (HPV, Shingrix)", "question_text_ar": "Ù„Ù‚Ø§Ø­Ø§Øª Ù…Ø¤ØªÙ„ÙØ© (HPVÃ˜Å’ Ø´ÙŠÙ†ØºØ±ÙŠÙƒØ³)", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": "Q15", "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R074", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V10", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "Intranasal flu (live attenuated)", "question_text_ar": "Ø¥Ù†ÙÙ„ÙˆÙ†Ø²Ø§ Ø£Ù†ÙÙŠØ© (Ø­ÙŠØ© Ù…Ø¶Ø¹ÙØ©)", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": "Q15", "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R075", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q14.V11", "parent_rule_id": "R065", "node_type": "vaccine_deferral", "is_followup": true, "trigger_answer": "VACCINE", "question_text_en": "Vaxchora (oral cholera)", "question_text_ar": "ÙØ§ÙƒØ³ÙƒÙˆØ±Ø§ (ÙƒÙˆÙ„ÙŠØ±Ø§ ÙÙ…ÙˆÙŠØ©)", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": "Q15", "next_if_no": null, "rationale_en": "Vaccine-specific deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R076", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Vaccine Deferral List"}, {"url": "https://www.cdc.gov/vaccines/", "source": "CDC - Vaccines & Immunizations"}]}}, {"question_number": "Q15", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In the past 8 weeks, have you had contact with someone vaccinated for smallpox?", "question_text_ar": "Ù‡Ù„ Ø®Ø§Ù„Ø·Øª Ø´Ø®ØµØ§Ù‹ ØªÙ„Ù‚Ù‰ Ù„Ù‚Ø§Ø­ Ø§Ù„Ø¬Ø¯Ø±ÙŠ Ø®Ù„Ø§Ù„ Ã™Â¨ Ø£Ø³Ø§Ø¨ÙŠØ¹ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CHECK_JYNNEOS_AND_COMPLICATIONS", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q15.1", "next_if_no": "Q16", "rationale_en": "Exposure to live vaccine site may transmit infection", "category": "vaccinations", "applies_to": "all", "rule_id": "R077"}, {"question_number": "Q15.1", "parent_rule_id": "R077", "node_type": "followup_question", "is_followup": true, "trigger_answer": "YES", "question_text_en": "Was the contact vaccinated with Jynneos (non-replicating)?", "question_text_ar": "Ù‡Ù„ ØªÙ„Ù‚Ù‰ Ø§Ù„Ø´Ø®Øµ Ù„Ù‚Ø§Ø­ Ø¬ÙŠÙ†ÙŠÙˆØ³ (ØºÙŠØ± Ù…ØªÙƒØ§Ø«Ø±)Ã˜Å¸", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": "CHECK_COMPLICATIONS", "next_if_yes": "Q16", "next_if_no": "Q15.2", "rationale_en": "Jynneos is non-replicating - no deferral", "category": "vaccinations", "applies_to": "all", "rule_id": "R078"}, {"question_number": "Q15.2", "parent_rule_id": "R077", "node_type": "followup_question", "is_followup": true, "trigger_answer": "NO_JYNNEOS", "question_text_en": "Did you have contact with vaccination site/bandages, or develop complications (rash, necrosis, encephalitis, eye infection)?", "question_text_ar": "Ù‡Ù„ Ù„Ø§Ù…Ø³Øª Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªØ·Ø¹ÙŠÙ… Ø£Ùˆ Ø§Ù„Ø¶Ù…Ø§Ø¯Ø§ØªØŒ Ø£Ùˆ Ø¸Ù‡Ø±Øª Ù…Ø¶Ø§Ø¹ÙØ§Øª (Ø·ÙØ­ØŒ Ù†Ø®Ø±ØŒ Ø§Ù„ØªÙ‡Ø§Ø¨ Ø¯Ù…Ø§ØºØŒ Ø¹Ø¯ÙˆÙ‰ Ø¹ÙŠÙ†)Ã˜Å¸", "deferral_type": "temporary", "deferral_duration": 56, "deferral_unit": "days", "outcome_if_yes": "DEFER_56_DAYS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q16", "rationale_en": "56 days if direct contact or complications", "category": "vaccinations", "applies_to": "all", "rule_id": "R079"}, {"question_number": "Q16", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In the past 8 weeks, have you donated blood, platelets, or plasma?", "question_text_ar": "Ù‡Ù„ ØªØ¨Ø±Ø¹Øª Ø¨Ø§Ù„Ø¯Ù… Ø£Ùˆ Ø§Ù„ØµÙØ§Ø¦Ø­ Ø£Ùˆ Ø§Ù„Ø¨Ù„Ø§Ø²Ù…Ø§ Ø®Ù„Ø§Ù„ Ã™Â¨ Ø£Ø³Ø§Ø¨ÙŠØ¹ØŸ", "deferral_type": "temporary", "deferral_duration": 8, "deferral_unit": "weeks", "outcome_if_yes": "DEFER_8_WEEKS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q17", "rationale_en": "Whole blood: 8 weeks minimum between donations", "category": "donation_history", "applies_to": "all", "rule_id": "R080"}, {"question_number": "Q17", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In the past 16 weeks, have you donated a double unit of red blood cells by apheresis?", "question_text_ar": "Ù‡Ù„ ØªØ¨Ø±Ø¹Øª Ø¨ÙˆØ­Ø¯ØªÙŠÙ† Ù…Ù† ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø¯Ù… Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ Ø¨Ø§Ù„ÙØµØ§Ø¯Ø© Ø®Ù„Ø§Ù„ Ù¡Ù¦ Ø£Ø³Ø¨ÙˆØ¹ØŸ", "deferral_type": "temporary", "deferral_duration": 16, "deferral_unit": "weeks", "outcome_if_yes": "DEFER_16_WEEKS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q18", "rationale_en": "Double red cell donation: 16 weeks minimum", "category": "donation_history", "applies_to": "all", "rule_id": "R081"}, {"question_number": "Q18", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had a positive test for hepatitis B or C?", "question_text_ar": "Ù‡Ù„ ÙƒØ§Ù† ØªØ­Ù„ÙŠÙ„ ÙÙŠØ±ÙˆØ³ Ø§Ù„ÙƒØ¨Ø¯ Ø¨ Ø£Ùˆ Ø¬ Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ§Ù‹ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: hepatitis", "category": "hepatitis", "applies_to": "all", "rule_id": "R082"}, {"question_number": "Q19", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In the past 6 months, sexual contact with person who has hepatitis?", "question_text_ar": "Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ù…Ø¹ Ù…ØµØ§Ø¨ Ø¨Ø§Ù„ØªÙ‡Ø§Ø¨ Ø§Ù„ÙƒØ¨Ø¯ Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R083", "definition_note": "Sexual contact is defined as vaginal sex (contact between penis and vagina), oral sex (mouth or tongue on someone's vagina, penis, or anus), or anal sex (contact between penis and anus) regardless of whether or not medications, condoms or other protection were used."}, {"question_number": "Q20", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In the past 6 months, lived with person who has hepatitis?", "question_text_ar": "Ø¹Ø´Øª Ù…Ø¹ Ù…ØµØ§Ø¨ Ø¨Ø§Ù„ØªÙ‡Ø§Ø¨ Ø§Ù„ÙƒØ¨Ø¯ Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R084"}, {"question_number": "Q21", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In the past 3 months, had syphilis or gonorrhea or treatment?", "question_text_ar": "Ø§Ù„Ø²Ù‡Ø±ÙŠ Ø£Ùˆ Ø§Ù„Ø³ÙŠÙ„Ø§Ù† Ø£Ùˆ Ø¹Ù„Ø§Ø¬Ù‡Ù…Ø§ Ø®Ù„Ø§Ù„ Ã™Â£ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 3, "deferral_unit": "months", "outcome_if_yes": "DEFER_3_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: sti", "category": "sti", "applies_to": "all", "rule_id": "R085"}, {"question_number": "Q22", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had a positive test for HIV?", "question_text_ar": "Ù‡Ù„ ÙƒØ§Ù† ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥ÙŠØ¯Ø² Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ§Ù‹ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: hiv", "category": "hiv", "applies_to": "all", "rule_id": "R086"}, {"question_number": "Q23", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER taken medication to treat HIV?", "question_text_ar": "Ù‡Ù„ Ø§Ø³ØªØ®Ø¯Ù…Øª Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø¥ÙŠØ¯Ø²ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: hiv", "category": "hiv", "applies_to": "all", "rule_id": "R087"}, {"question_number": "Q24", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you ever received medication to prevent HIV (PrEP or PEP)?", "question_text_ar": "Ù‡Ù„ Ø§Ø³ØªØ®Ø¯Ù…Øª Ø¯ÙˆØ§Ø¡ Ù„Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø¥ÙŠØ¯Ø²ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CHECK_REASON_FOR_USE", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q24.1", "next_if_no": "Q25", "rationale_en": "Deferral depends on reason for use and route", "category": "hiv_prevention", "applies_to": "all", "rule_id": "R088"}, {"question_number": "Q24.1", "parent_rule_id": "R089", "node_type": "followup_question", "is_followup": true, "trigger_answer": "YES", "question_text_en": "What was the reason for use? (Same-sex contact or extramarital = permanent; Medical exposure = 6 months oral / 2 years injection)", "question_text_ar": "Ù…Ø§ Ø³Ø¨Ø¨ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…ØŸ (Ù…Ø«Ù„ÙŠØ© Ø£Ùˆ Ø®Ø§Ø±Ø¬ Ø§Ù„Ø²ÙˆØ§Ø¬ = Ø¯Ø§Ø¦Ù…Ø› ØªØ¹Ø±Ø¶ Ø·Ø¨ÙŠ = Ã™Â¦ Ø£Ø´Ù‡Ø± ÙÙ…ÙˆÙŠ / Ø³Ù†ØªØ§Ù† Ø­Ù‚Ù†)", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "EVALUATE_REASON", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "High-risk behavior = permanent; Medical exposure = temporary", "category": "hiv_prevention", "applies_to": "all", "rule_id": "R089"}, {"question_number": "Q25", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had sexual contact outside of marriage?", "question_text_ar": "Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ø®Ø§Ø±Ø¬ Ø§Ù„Ø²ÙˆØ§Ø¬ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: sexual_history", "category": "sexual_history", "applies_to": "all", "rule_id": "R090", "definition_note": "Sexual contact is defined as vaginal sex (contact between penis and vagina), oral sex (mouth or tongue on someone's vagina, penis, or anus), or anal sex (contact between penis and anus) regardless of whether or not medications, condoms or other protection were used."}, {"question_number": "Q26", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had sexual contact with same gender?", "question_text_ar": "Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ù…Ø«Ù„ÙŠØ©ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: sexual_history", "category": "sexual_history", "applies_to": "all", "rule_id": "R091", "definition_note": "Sexual contact is defined as vaginal sex (contact between penis and vagina), oral sex (mouth or tongue on someone's vagina, penis, or anus), or anal sex (contact between penis and anus) regardless of whether or not medications, condoms or other protection were used."}, {"question_number": "Q27", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 12 months, sexual contact with unofficial marriage?", "question_text_ar": "Ø¹Ù„Ø§Ù‚Ø© Ø¨Ø¹Ù‚Ø¯ Ø²ÙˆØ§Ø¬ ØºÙŠØ± Ù…ÙˆØ«Ù‚ Ø®Ù„Ø§Ù„ Ù¡Ù¢ Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 12, "deferral_unit": "months", "outcome_if_yes": "DEFER_12_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: sexual_history", "category": "sexual_history", "applies_to": "all", "rule_id": "R092", "definition_note": "Sexual contact is defined as vaginal sex (contact between penis and vagina), oral sex (mouth or tongue on someone's vagina, penis, or anus), or anal sex (contact between penis and anus) regardless of whether or not medications, condoms or other protection were used."}, {"question_number": "Q28", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, sexual contact with HIV+ person?", "question_text_ar": "Ø¹Ù„Ø§Ù‚Ø© Ù…Ø¹ Ù…ØµØ§Ø¨ Ø¨Ø§Ù„Ø¥ÙŠØ¯Ø² Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R093", "definition_note": "Sexual contact is defined as vaginal sex (contact between penis and vagina), oral sex (mouth or tongue on someone's vagina, penis, or anus), or anal sex (contact between penis and anus) regardless of whether or not medications, condoms or other protection were used."}, {"question_number": "Q29", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER received payment for sex?", "question_text_ar": "ØªÙ„Ù‚ÙŠØª Ù…Ù‚Ø§Ø¨Ù„Ø§Ù‹ Ù„Ù„Ø¬Ù†Ø³ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: sexual_history", "category": "sexual_history", "applies_to": "all", "rule_id": "R094", "definition_note": "Sexual contact is defined as vaginal sex (contact between penis and vagina), oral sex (mouth or tongue on someone's vagina, penis, or anus), or anal sex (contact between penis and anus) regardless of whether or not medications, condoms or other protection were used."}, {"question_number": "Q30", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had sex with someone who received payment for sex?", "question_text_ar": "Ø¹Ù„Ø§Ù‚Ø© Ù…Ø¹ Ù…Ù† ØªÙ„Ù‚Ù‰ Ù…Ù‚Ø§Ø¨Ù„Ø§Ù‹ Ù„Ù„Ø¬Ù†Ø³ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: sexual_history", "category": "sexual_history", "applies_to": "all", "rule_id": "R095", "definition_note": "Sexual contact is defined as vaginal sex (contact between penis and vagina), oral sex (mouth or tongue on someone's vagina, penis, or anus), or anal sex (contact between penis and anus) regardless of whether or not medications, condoms or other protection were used."}, {"question_number": "Q31", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER injected non-prescribed drugs/steroids?", "question_text_ar": "Ø­Ù‚Ù† Ø£Ø¯ÙˆÙŠØ© ØºÙŠØ± Ù…ÙˆØµÙˆÙØ©ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: drug_use", "category": "drug_use", "applies_to": "all", "rule_id": "R096"}, {"question_number": "Q32", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, sexual contact with injection drug user?", "question_text_ar": "Ø¹Ù„Ø§Ù‚Ø© Ù…Ø¹ Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆÙŠØ© Ø¨Ø§Ù„Ø­Ù‚Ù† Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R097", "definition_note": "Sexual contact is defined as vaginal sex (contact between penis and vagina), oral sex (mouth or tongue on someone's vagina, penis, or anus), or anal sex (contact between penis and anus) regardless of whether or not medications, condoms or other protection were used."}, {"question_number": "Q33", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, accidental needle-stick?", "question_text_ar": "ÙˆØ®Ø² Ø¥Ø¨Ø±Ø© Ø¹Ø±Ø¶ÙŠ Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R098"}, {"question_number": "Q34", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, contact with someone else's blood?", "question_text_ar": "Ù„Ø§Ù…Ø³Øª Ø¯Ù… Ø´Ø®Øµ Ø¢Ø®Ø± Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R099"}, {"question_number": "Q35", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, tattoo or cosmetic procedure with needles?", "question_text_ar": "ÙˆØ´Ù… Ø£Ùˆ Ø¥Ø¬Ø±Ø§Ø¡ ØªØ¬Ù…ÙŠÙ„ÙŠ Ø¨Ø§Ù„Ø¥Ø¨Ø± Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R100"}, {"question_number": "Q36", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, ear or body piercing?", "question_text_ar": "Ø«Ù‚Ø¨ Ø£Ø°Ã™â€  Ø£Ùˆ Ø¬Ø³Ù… Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R101"}, {"question_number": "Q37", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, hijama (wet cupping)?", "question_text_ar": "Ø­Ø¬Ø§Ù…Ø© Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R102"}, {"question_number": "Q38", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, blood transfusion?", "question_text_ar": "Ù†Ù‚Ù„ Ø¯Ù… Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R103"}, {"question_number": "Q39", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 6 months, bone or skin graft?", "question_text_ar": "Ø±Ù‚Ø¹Ø© Ø¹Ø¸Ù…ÙŠØ© Ø£Ùˆ Ø¬Ù„Ø¯ÙŠØ© Ø®Ù„Ø§Ù„ Ã™Â¦ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R104"}, {"question_number": "Q40", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 12 months, incarcerated 72+ hours?", "question_text_ar": "Ø³Ø¬Ù† Ã™Â§Ã™Â¢+ Ø³Ø§Ø¹Ø© Ø®Ù„Ø§Ù„ Ù¡Ù¢ Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 12, "deferral_unit": "months", "outcome_if_yes": "DEFER_12_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R105"}, {"question_number": "Q41", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you been outside Saudi Arabia in the past 3 years?", "question_text_ar": "Ù‡Ù„ Ø³Ø§ÙØ±Øª Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø®Ù„Ø§Ù„ Ã™Â£ Ø³Ù†ÙˆØ§ØªØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "EVALUATE_OUTBREAKS", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q42", "next_if_no": "Q42", "rationale_en": "Evaluate for disease outbreaks: Ebola=8w, WNV=120d", "category": "travel", "applies_to": "all", "rule_id": "R106", "reference_urls": {"urls": [{"url": "https://www.pha.gov.sa/ar-sa/Pages/default.aspx", "source": "Saudi Public Health Authority"}, {"url": "https://shc.gov.sa/en/Pages/default.aspx", "source": "Saudi Health Council"}, {"url": "https://www.moh.gov.sa/Pages/default.aspx", "source": "Ministry of Health"}]}}, {"question_number": "Q42", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you visited or lived in a malaria-endemic area in the past 3 years?", "question_text_ar": "Ù‡Ù„ Ø²Ø±Øª Ø£Ùˆ Ø¹Ø´Øª ÙÙŠ Ù…Ù†Ø·Ù‚Ø© Ù…ÙˆØ¨ÙˆØ¡Ø© Ø¨Ø§Ù„Ù…Ù„Ø§Ø±ÙŠØ§ Ø®Ù„Ø§Ù„ Ã™Â£ Ø³Ù†ÙˆØ§ØªØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CONTINUE_MALARIA_ASSESSMENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q42.1", "next_if_no": "Q43", "rationale_en": "Complex decision tree for malaria exposure", "category": "malaria", "applies_to": "all", "rule_id": "R107", "reference_urls": {"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/preparing/yellow-fever-vaccine-malaria-prevention-by-country/", "source": "CDC Yellow Book"}}, {"question_number": "Q42.1", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "Length of stay in endemic country(ies)?", "question_text_ar": "Ù…Ø¯Ø© Ø§Ù„Ø¥Ù‚Ø§Ù…Ø© ÙÙŠ Ø¯ÙˆÙ„Ø© Ù…ÙˆØ¨ÙˆØ¡Ø©ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "BRANCH_BY_DURATION", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R108", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.2a", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "Stay â‰¤5 years: Was donor in any endemic AREA?", "question_text_ar": "Ø¥Ù‚Ø§Ù…Ø© â‰¤Ã™Â¥ Ø³Ù†ÙˆØ§Øª: Ù‡Ù„ ÙƒØ§Ù† ÙÙŠ Ù…Ù†Ø·Ù‚Ø© Ù…ÙˆØ¨ÙˆØ¡Ø©ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "BRANCH_TO_Q42.3", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R109", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.2b", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "Stay >5 years: RESIDENT status - continue assessment", "question_text_ar": "Ø¥Ù‚Ø§Ù…Ø© >Ã™Â¥ Ø³Ù†ÙˆØ§Øª: Ø­Ø§Ù„Ø© Ù…Ù‚ÙŠÙ… - Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "BRANCH_TO_Q42.4", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R110", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.3a", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "Stay in endemic area â‰¤24 hours: ELIGIBLE", "question_text_ar": "Ø¥Ù‚Ø§Ù…Ø© ÙÙŠ Ù…Ù†Ø·Ù‚Ø© Ù…ÙˆØ¨ÙˆØ¡Ø© â‰¤Ù¢Ù¤ Ø³Ø§Ø¹Ø©: Ù…Ø¤Ù‡Ù„", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R111", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.3b", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "Stay in endemic area >24 hours: Check residency history", "question_text_ar": "Ø¥Ù‚Ø§Ù…Ø© ÙÙŠ Ù…Ù†Ø·Ù‚Ø© Ù…ÙˆØ¨ÙˆØ¡Ø© >Ù¢Ù¤ Ø³Ø§Ø¹Ø©: ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "BRANCH_TO_Q42.4", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R112", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.4", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "Was donor EVER resident (>5y) of endemic country before this travel?", "question_text_ar": "Ù‡Ù„ ÙƒØ§Ù† Ø§Ù„Ù…ØªØ¨Ø±Ø¹ Ù…Ù‚ÙŠÙ…Ø§Ù‹ (>Ã™Â¥ Ø³Ù†ÙˆØ§Øª) Ù‚Ø¨Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø³ÙØ±ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "BRANCH_BY_RESIDENCY", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R113", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.5", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "After residency, did donor have 3-year malaria-free period in non-endemic country?", "question_text_ar": "Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©ØŒ Ù‡Ù„ Ù…Ø±Øª Ã™Â£ Ø³Ù†ÙˆØ§Øª ÙÙŠ Ø¨Ù„Ø¯ ØºÙŠØ± Ù…ÙˆØ¨ÙˆØ¡ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "BRANCH_BY_3Y_CLEAR", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R114", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.6", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "Has donor traveled (>24h) to endemic area after leaving endemic country of residence?", "question_text_ar": "Ù‡Ù„ Ø³Ø§ÙØ± Ø§Ù„Ù…ØªØ¨Ø±Ø¹ (>Ù¢Ù¤Ø³) Ù„Ù…Ù†Ø·Ù‚Ø© Ù…ÙˆØ¨ÙˆØ¡Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "FINAL_OUTCOME", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R115", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.7", "parent_rule_id": "R107", "node_type": "followup_question", "is_followup": true, "trigger_answer": "MALARIA_ASSESSMENT", "question_text_en": "Will collection be pathogen-reduced platelets/plasma?", "question_text_ar": "Ù‡Ù„ Ø³ÙŠÙƒÙˆÙ† Ø§Ù„ØªØ¬Ù…ÙŠØ¹ ØµÙØ§Ø¦Ø­/Ø¨Ù„Ø§Ø²Ù…Ø§ Ù…Ø¹Ø§Ù„Ø¬Ø©ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE_IF_PATHOGEN_REDUCED", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Malaria decision tree node", "category": "malaria", "applies_to": "all", "rule_id": "R116", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.OUT1", "parent_rule_id": "R107", "node_type": "followup_outcome", "is_followup": true, "trigger_answer": "NON_RESIDENT_TRAVELER", "question_text_en": "Non-resident traveler to endemic area: Defer 3 months from departure", "question_text_ar": "Ù…Ø³Ø§ÙØ± ØºÙŠØ± Ù…Ù‚ÙŠÙ… Ù„Ù…Ù†Ø·Ù‚Ø© Ù…ÙˆØ¨ÙˆØ¡Ø©: ØªØ£Ø¬ÙŠÙ„ Ã™Â£ Ø£Ø´Ù‡Ø±", "deferral_type": "temporary", "deferral_duration": 3, "deferral_unit": "months", "outcome_if_yes": "DEFER_3_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "3 months from departure from endemic area", "category": "malaria", "applies_to": "all", "rule_id": "R117", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.OUT2", "parent_rule_id": "R107", "node_type": "followup_outcome", "is_followup": true, "trigger_answer": "RESIDENT_WITH_RECENT_TRAVEL", "question_text_en": "Resident with recent travel to endemic area: Defer 3 years from most recent departure", "question_text_ar": "Ù…Ù‚ÙŠÙ… Ø³Ø§ÙØ± Ø­Ø¯ÙŠØ«Ø§Ù‹: ØªØ£Ø¬ÙŠÙ„ Ã™Â£ Ø³Ù†ÙˆØ§Øª", "deferral_type": "temporary", "deferral_duration": 3, "deferral_unit": "years", "outcome_if_yes": "DEFER_3_YEARS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "3 years from most recent departure from endemic AREA", "category": "malaria", "applies_to": "all", "rule_id": "R118", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q42.OUT3", "parent_rule_id": "R107", "node_type": "followup_outcome", "is_followup": true, "trigger_answer": "RESIDENT_NO_RECENT_TRAVEL", "question_text_en": "Resident without recent travel: Defer 3 years from departure from country of residence", "question_text_ar": "Ù…Ù‚ÙŠÙ… Ø¨Ø¯ÙˆÙ† Ø³ÙØ± Ø­Ø¯ÙŠØ«: ØªØ£Ø¬ÙŠÙ„ Ã™Â£ Ø³Ù†ÙˆØ§Øª Ù…Ù† Ù…ØºØ§Ø¯Ø±Ø© Ø¨Ù„Ø¯ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø©", "deferral_type": "temporary", "deferral_duration": 3, "deferral_unit": "years", "outcome_if_yes": "DEFER_3_YEARS_FROM_COUNTRY", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "3 years from departure from endemic COUNTRY of residence", "category": "malaria", "applies_to": "all", "rule_id": "R119", "reference_urls": {"urls": [{"url": "https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria", "source": "CDC Yellow Book - Malaria"}, {"url": "https://www.who.int/news-room/fact-sheets/detail/malaria", "source": "WHO - Malaria Fact Sheet"}]}}, {"question_number": "Q43", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had malaria?", "question_text_ar": "Ù‡Ù„ Ø£ØµØ¨Øª Ø¨Ø§Ù„Ù…Ù„Ø§Ø±ÙŠØ§ØŸ", "deferral_type": "temporary", "deferral_duration": 3, "deferral_unit": "years", "outcome_if_yes": "DEFER_3_YEARS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: infectious_disease", "category": "infectious_disease", "applies_to": "all", "rule_id": "R120"}, {"question_number": "Q44", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had brucellosis (Malta fever)?", "question_text_ar": "Ù‡Ù„ Ø´ÙØ®ØµØª Ø¨Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠÙ„Ø§ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: infectious_disease", "category": "infectious_disease", "applies_to": "all", "rule_id": "R121"}, {"question_number": "Q45", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 2 months, consumed raw/unpasteurized milk/dairy?", "question_text_ar": "Ø­Ù„ÙŠØ¨ ØºÙŠØ± Ù…Ø¨Ø³ØªØ± Ø®Ù„Ø§Ù„ Ø´Ù‡Ø±ÙŠÙ†ØŸ", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "months", "outcome_if_yes": "DEFER_2_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: exposure", "category": "exposure", "applies_to": "all", "rule_id": "R122"}, {"question_number": "Q46", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "In past 4 months, had dengue virus infection?", "question_text_ar": "Ø­Ù…Ù‰ Ø§Ù„Ø¶Ù†Ùƒ Ø®Ù„Ø§Ù„ Ã™Â¤ Ø£Ø´Ù‡Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 4, "deferral_unit": "months", "outcome_if_yes": "DEFER_4_MONTHS", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: infectious_disease", "category": "infectious_disease", "applies_to": "all", "rule_id": "R123"}, {"question_number": "Q47", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had positive test for Babesia?", "question_text_ar": "ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨Ø§Ø¨Ø³ÙŠØ§Øª Ø¥ÙŠØ¬Ø§Ø¨ÙŠØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: infectious_disease", "category": "infectious_disease", "applies_to": "all", "rule_id": "R124"}, {"question_number": "Q48", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had Chagas disease?", "question_text_ar": "Ø¯Ø§Ø¡ Ø´Ø§ØºØ§Ø³ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": null, "rationale_en": "Category: infectious_disease", "category": "infectious_disease", "applies_to": "all", "rule_id": "R125"}, {"question_number": "Q49", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER been to Mexico, Central America, or South America?", "question_text_ar": "Ù‡Ù„ Ø²Ø±Øª Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ Ø£Ùˆ Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„ÙˆØ³Ø·Ù‰ Ø£Ùˆ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CHECK_CHAGAS_RISK", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q49.1", "next_if_no": "Q50", "rationale_en": "T. cruzi (Chagas) risk assessment", "category": "travel", "applies_to": "all", "rule_id": "R126"}, {"question_number": "Q49.1", "parent_rule_id": "R127", "node_type": "followup_question", "is_followup": true, "trigger_answer": "YES", "question_text_en": "Have you lived there for 6 continuous months or more?", "question_text_ar": "Ù‡Ù„ Ø¹Ø´Øª Ù‡Ù†Ø§Ùƒ Ã™Â¦ Ø£Ø´Ù‡Ø± Ù…ØªÙˆØ§ØµÙ„Ø© Ø£Ùˆ Ø£ÙƒØ«Ø±ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_INDEFINITE", "outcome_if_no": "CHECK_TRANSFUSION", "next_if_yes": null, "next_if_no": "Q49.2", "rationale_en": "â‰¥6 months = indefinite deferral for Chagas", "category": "travel", "applies_to": "all", "rule_id": "R127"}, {"question_number": "Q49.2", "parent_rule_id": "R127", "node_type": "followup_question", "is_followup": true, "trigger_answer": "NO_6_MONTHS", "question_text_en": "Have you received a blood transfusion there?", "question_text_ar": "Ù‡Ù„ ØªÙ„Ù‚ÙŠØª Ù†Ù‚Ù„ Ø¯Ù… Ù‡Ù†Ø§ÙƒØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_INDEFINITE", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q50", "rationale_en": "Transfusion in endemic area = indefinite deferral", "category": "travel", "applies_to": "all", "rule_id": "R128"}, {"question_number": "Q50", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Were you or your mother born in Mexico, Central America, or South America?", "question_text_ar": "Ù‡Ù„ ÙˆÙ„Ø¯Øª Ø£Ù†Øª Ø£Ùˆ ÙˆØ§Ù„Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ Ø£Ùˆ Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„ÙˆØ³Ø·Ù‰/Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©ØŸ", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_INDEFINITE", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q51", "rationale_en": "Vertical transmission risk for T. cruzi", "category": "travel", "applies_to": "all", "rule_id": "R129"}, {"question_number": "Q51", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you EVER had brain surgery?", "question_text_ar": "Ù‡Ù„ Ø£Ø¬Ø±ÙŠØª Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø®ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "CHECK_DURA_MATER", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q51.1", "next_if_no": "Q52", "rationale_en": "Cadaveric dura mater = permanent (CJD); others = no deferral", "category": "medical_history", "applies_to": "all", "rule_id": "R130"}, {"question_number": "Q52", "parent_rule_id": null, "node_type": "main_question", "is_followup": false, "trigger_answer": null, "question_text_en": "Have you had transplantation of organ, tissue, or cells (bone marrow, stem cells)?", "question_text_ar": "Ù‡Ù„ ØªÙ„Ù‚ÙŠØª Ø²Ø±Ø§Ø¹Ø© Ø¹Ø¶Ùˆ Ø£Ùˆ Ù†Ø³ÙŠØ¬ Ø£Ùˆ Ø®Ù„Ø§ÙŠØ§ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "EVALUATE_TRANSPLANT_TYPE", "outcome_if_no": "ELIGIBLE", "next_if_yes": "Q52.1", "next_if_no": null, "rationale_en": "Allogeneic=6m; Autologous=0; Xeno=permanent", "category": "medical_history", "applies_to": "all", "rule_id": "R131"}, {"question_number": "Q52.1a", "parent_rule_id": "R133", "node_type": "followup_outcome", "is_followup": true, "trigger_answer": "ALLOGENEIC", "question_text_en": "Allogeneic (from another person): Defer 6 months", "question_text_ar": "Ù…Ù† Ø´Ø®Øµ Ø¢Ø®Ø±: ØªØ£Ø¬ÙŠÙ„ Ã™Â¦ Ø£Ø´Ù‡Ø±", "deferral_type": "temporary", "deferral_duration": 6, "deferral_unit": "months", "outcome_if_yes": "DEFER_6_MONTHS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Risk of infectious disease from donor", "category": "medical_history", "applies_to": "all", "rule_id": "R132"}, {"question_number": "Q52.1b", "parent_rule_id": "R133", "node_type": "followup_outcome", "is_followup": true, "trigger_answer": "AUTOLOGOUS", "question_text_en": "Autologous (own tissue): No deferral", "question_text_ar": "Ø°Ø§ØªÙŠ: Ø¨Ø¯ÙˆÙ† ØªØ£Ø¬ÙŠÙ„", "deferral_type": "none", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "ELIGIBLE", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Own tissue = no risk", "category": "medical_history", "applies_to": "all", "rule_id": "R133"}, {"question_number": "Q52.1c", "parent_rule_id": "R133", "node_type": "followup_outcome", "is_followup": true, "trigger_answer": "XENOTRANSPLANT", "question_text_en": "Xenotransplantation (animal): Permanent deferral", "question_text_ar": "Ù…Ù† Ø­ÙŠÙˆØ§Ù†: ØªØ£Ø¬ÙŠÙ„ Ø¯Ø§Ø¦Ù…", "deferral_type": "permanent", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Unknown infectious risks from animal sources", "category": "medical_history", "applies_to": "all", "rule_id": "R134"}, {"question_number": "Q13.M33", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Dalteparin (Fragmin)", "question_text_ar": "ÙØ±Ø§ØºÙ…ÙŠÙ† (Ø¯Ø§Ù„ØªÙŠØ¨Ø§Ø±ÙŠÙ†)", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Anticoagulant - affects blood's ability to clot", "category": "medications", "applies_to": "all", "rule_id": "R135", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q13.M34", "parent_rule_id": "R032", "node_type": "medication_deferral", "is_followup": true, "trigger_answer": "MEDICATION", "question_text_en": "Edoxaban (Savaysa, Lixiana)", "question_text_ar": "Ø³Ø§ÙØ§ÙŠØ³Ø§ / Ù„ÙŠÙƒØ³ÙŠØ§Ù†Ø§ (Ø¥ÙŠØ¯ÙˆÙƒØ³Ø§Ø¨Ø§Ù†)", "deferral_type": "temporary", "deferral_duration": 2, "deferral_unit": "days", "outcome_if_yes": "DEFER_2_DAYS", "outcome_if_no": null, "next_if_yes": null, "next_if_no": null, "rationale_en": "Anticoagulant - affects blood's ability to clot", "category": "medications", "applies_to": "all", "rule_id": "R136", "reference_urls": {"urls": [{"url": "https://www.redcrossblood.org/donate-blood/how-to-donate/eligibility-requirements/eligibility-criteria-alphabetical/eligibility-reference-material.html", "source": "American Red Cross - Medication Deferral List"}, {"url": "https://www.blood.co.uk/who-can-give-blood/", "source": "NHS Blood - Eligibility Guidelines"}]}}, {"question_number": "Q5.1", "parent_rule_id": "R018", "node_type": "followup_question", "is_followup": true, "trigger_answer": "YES", "question_text_en": "Were oral or intravenous antibiotics used for treatment?", "question_text_ar": "Ù‡Ù„ Ø§Ø³ØªØ®Ø¯Ù…Øª Ù…Ø¶Ø§Ø¯Ø§Øª Ø­ÙŠÙˆÙŠØ© ÙÙ…ÙˆÙŠØ© Ø£Ùˆ ÙˆØ±ÙŠØ¯ÙŠØ© Ù„Ù„Ø¹Ù„Ø§Ø¬ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_4_WEEKS", "outcome_if_no": "DEFER_2_WEEKS", "next_if_yes": null, "next_if_no": "Q6", "rationale_en": "If antibiotics used: 4 weeks after completion of treatment. Without antibiotics: 2 weeks after healing.", "category": "general_health", "applies_to": "all", "rule_id": "R137"}, {"question_number": "Q6.2", "parent_rule_id": "R019", "node_type": "followup_question", "is_followup": true, "trigger_answer": "NO_HEMATOLOGICAL", "question_text_en": "Are you cancer-free with last treatment â‰¥12 months ago?", "question_text_ar": "Ù‡Ù„ Ø£Ù†Øª Ø®Ø§Ù„Ù Ù…Ù† Ø§Ù„Ø³Ø±Ø·Ø§Ù† ÙˆØ¢Ø®Ø± Ø¹Ù„Ø§Ø¬ Ù‚Ø¨Ù„ Ù¡Ù¢ Ø´Ù‡Ø± Ø£Ùˆ Ø£ÙƒØ«Ø±ØŸ", "deferral_type": "temporary", "deferral_duration": 12, "deferral_unit": "months", "outcome_if_yes": "ELIGIBLE_PER_PHYSICIAN", "outcome_if_no": "DEFER_UNTIL_12_MONTHS_POST_TREATMENT", "next_if_yes": "Q7", "next_if_no": null, "rationale_en": "Non-hematological cancer: May donate if cancer-free and last treatment â‰¥12 months ago. Per blood bank physician judgment.", "category": "medical_history", "applies_to": "all", "rule_id": "R138"}, {"question_number": "Q51.1", "parent_rule_id": "R130", "node_type": "followup_question", "is_followup": true, "trigger_answer": "YES", "question_text_en": "Did you receive a human cadaveric dura mater transplant or graft?", "question_text_ar": "Ù‡Ù„ ØªÙ„Ù‚ÙŠØª Ø²Ø±Ø¹ Ø£Ù… Ø§Ù„Ø³Ø­Ø§ÙŠØ§ Ù…Ù† Ù…ØªÙˆÙÙ‰ØŸ", "deferral_type": "variable", "deferral_duration": null, "deferral_unit": null, "outcome_if_yes": "DEFER_PERMANENT", "outcome_if_no": "ELIGIBLE", "next_if_yes": null, "next_if_no": "Q52", "rationale_en": "Cadaveric dura mater transplant = permanent deferral due to Creutzfeldt-Jakob Disease (CJD) risk. Other brain surgeries have no deferral.", "category": "medical_history", "applies_to": "all", "rule_id": "R139"}]};

// Eligibility requirements (shown as info before questionnaire)
const ELIGIBILITY_REQUIREMENTS = [
  { en: 'Age â‰¥18 years (17-18 with parental consent)', ar: 'Ø£Ù„Ø§ ÙŠÙ‚Ù„ Ø§Ù„Ø¹Ù…Ø± Ø¹Ù† Ù¡Ù¨ Ø¹Ø§Ù…Ø§Ù‹ (ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨ÙŠÙ† Ã™Â¡Ã™Â§ ÙˆÙ¡Ù¨ Ø¹Ø§Ù…Ø§Ù‹ Ø¨Ø¥Ø°Ù† Ø®Ø·ÙŠ Ù…Ù† ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±)' },
  { en: 'Valid Saudi ID or Iqama', ar: 'Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø© Ø³Ø§Ø±ÙŠØ© Ø§Ù„Ù…ÙØ¹ÙˆÙ„' },
  { en: 'Ability to understand Arabic or English', ar: 'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ÙÙ‡Ù… Ø§Ù„Ø§Ø³ØªØ¨Ø§Ù†Ø© Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©' },
  { en: 'Good general health', ar: 'ØµØ­Ø© Ø¬ÙŠØ¯Ø© Ø¨Ø´ÙƒÙ„Ù Ø¹Ø§Ù…' },
  { en: 'Hemoglobin â‰¥13 g/dL, Hematocrit â‰¥39% (males)', ar: 'Ø§Ù„Ù‡ÙŠÙ…ÙˆØ¬Ù„ÙˆØ¨ÙŠÙ† â‰¥Ù¡Ù£ Ø¬Ù…/Ø¯ÙŠØ³ÙŠÙ„ÙŠØªØ± ÙˆØ§Ù„Ù‡ÙŠÙ…Ø§ØªÙˆÙƒØ±ÙŠØª â‰¥Ù£Ù©Ùª (Ù„Ù„Ø±Ø¬Ø§Ù„)' },
  { en: 'Hemoglobin â‰¥12.5 g/dL, Hematocrit â‰¥38% (females)', ar: 'Ø§Ù„Ù‡ÙŠÙ…ÙˆØ¬Ù„ÙˆØ¨ÙŠÙ† â‰¥Ù¡Ù¢.Ã™Â¥ Ø¬Ù…/Ø¯ÙŠØ³ÙŠÙ„ÙŠØªØ± ÙˆØ§Ù„Ù‡ÙŠÙ…Ø§ØªÙˆÙƒØ±ÙŠØª â‰¥Ù£Ù¨Ùª (Ù„Ù„Ù†Ø³Ø§Ø¡)' },
  { en: 'Temperature â‰¤37.5Â°C (oral)', ar: 'Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ù„Ø§ ØªØ²ÙŠØ¯ Ø¹Ù† Ã™Â£Ã™Â§.Ã™Â¥ Ø¯Ø±Ø¬Ø© Ù…Ø¦ÙˆÙŠØ©' },
  { en: 'Blood pressure: Systolic 90-180, Diastolic 50-100 mmHg', ar: 'Ø¶ØºØ· Ø§Ù„Ø¯Ù… Ø§Ù„Ø§Ù†Ù‚Ø¨Ø§Ø¶ÙŠ Ù©Ù -Ù¡Ù¨Ù  ÙˆØ§Ù„Ø§Ù†Ø¨Ø³Ø§Ø·ÙŠ Ù¥Ù -Ù¡Ù Ù  Ù…Ù… Ø²Ø¦Ø¨Ù‚' },
  { en: 'Pulse 50-100 bpm, regular', ar: 'Ø§Ù„Ù†Ø¨Ø¶ Ù¥Ù -Ù¡Ù Ù  Ù†Ø¨Ø¶Ø©/Ø¯Ù‚ÙŠÙ‚Ø©ØŒ Ù…Ù†ØªØ¸Ù…' },
  { en: 'Weight â‰¥50 kg', ar: 'Ø§Ù„ÙˆØ²Ù† â‰¥Ù¥Ù  ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…' },
];

// Reference links
const REFERENCE_LINKS = {
  pha: { url: 'https://pha.gov.sa', name: 'Saudi Public Health Authority', nameAr: 'Ù‡ÙŠØ¦Ø© Ø§Ù„ØµØ­Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©' },
  moh: { url: 'https://moh.gov.sa', name: 'Ministry of Health', nameAr: 'ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØµØ­Ø©' },
  shc: { url: 'https://shc.gov.sa', name: 'Saudi Health Council', nameAr: 'Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„ØµØ­ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ' },
  cdc_malaria: { url: 'https://wwwnc.cdc.gov/travel/yellowbook/2024/infections-diseases/malaria', name: 'CDC - Malaria Endemic Areas', nameAr: 'Ù…Ø±Ø§ÙƒØ² Ø§Ù„Ø³ÙŠØ·Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ - Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ù„Ø§Ø±ÙŠØ§' },
};

// EXACT questions from the Saudi National Blood Bank DHQ - matching questionnaire document exactly
const QUESTIONS = [
  // General Health Questions
  { id: 'Q1', en: 'Are you feeling healthy and well to donate blood today?', ar: 'Ù‡Ù„ ØªØ´Ø¹Ø± Ø£Ù†Ùƒ Ø¨ØµØ­Ø© Ø¬ÙŠØ¯Ø© Ù„Ù„ØªØ¨Ø±Ø¹ Ø¨Ø§Ù„Ø¯Ù… Ø§Ù„ÙŠÙˆÙ…ØŸ', category: 'general_health' },
  { id: 'Q2', en: 'Have you read the blood donor educational materials today? and were all your questions answered to your satisfaction?', ar: 'Ù‡Ù„ Ø§Ø·Ù„Ø¹Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„ØªØ«Ù‚ÙŠÙÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ† Ø¨Ø§Ù„Ø¯Ù… Ø§Ù„ÙŠÙˆÙ… ÙˆØ£Ø¬ÙŠØ¨ Ø¹Ù† Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ Ø¨Ø´ÙƒÙ„Ù Ù…Ø±Ø¶ÙØŸ', category: 'general_health' },
  { id: 'Q3', en: 'Have you ever been refused as a blood donor, or told not to donate blood?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ù…Ù†Ø¹Ùƒ Ù…Ù† Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ø§Ù„Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§ØŸ', category: 'general_health' },
  { id: 'Q4', en: 'Have you been to the dentist for a procedure during the past 7 days?', ar: 'Ù‡Ù„ Ø²Ø±Øª Ø·Ø¨ÙŠØ¨ Ø§Ù„Ø£Ø³Ù†Ø§Ù† Ù„Ø£ÙŠ Ø¹Ø§Ø±Ø¶ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù§ Ø£ÙŠØ§Ù…ØŸ', category: 'dental', followup: 'dental' },
  { id: 'Q5', en: 'Have you had a wound or a skin infection in the past 2 weeks?', ar: 'Ù‡Ù„ Ø£ØµØ¨Øª Ø¨Ø¬Ø±Ø­ Ø£Ùˆ Ø§Ù„ØªÙ‡Ø§Ø¨ ÙÙŠ Ø§Ù„Ø¬Ù„Ø¯ Ø®Ù„Ø§Ù„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ† Ø§Ù„Ø£Ø®ÙŠØ±ÙŠÙ†ØŸ', category: 'general_health', followup: 'wound' },
  { id: 'Q6', en: 'Have you ever had any type of cancer, including leukemia?', ar: 'Ù‡Ù„ Ø¬Ø±Ù‰ ØªØ´Ø®ÙŠØµÙƒ Ø¨Ø£ÙŠ Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø³Ø±Ø·Ø§Ù†ØŸ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø¯Ù… (Ø§Ù„Ù„ÙˆÙƒÙŠÙ…ÙŠØ§)ØŸ', category: 'medical_conditions' },
  { id: 'Q7', en: 'Have you ever had any problems with your heart or lungs?', ar: 'Ù‡Ù„ Ø´ÙØ®ØµØª Ø¨Ø£ÙŠ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø§Ù„Ù‚Ù„Ø¨ Ø£Ùˆ Ø§Ù„Ø±Ø¦ØªÙŠÙ†ØŸ', category: 'medical_conditions' },
  { id: 'Q8', en: 'Have you ever had a bleeding condition or blood disease?', ar: 'Ù‡Ù„ Ø´ÙØ®ØµØª Ø¨Ø³ÙŠÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ø¯Ù… Ø£Ùˆ Ù…Ø±Ø¶ ÙÙŠ Ø§Ù„Ø¯Ù…ØŸ', category: 'medical_conditions' },
  { id: 'Q9', en: 'Do you have diabetes?', ar: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØµØ§Ø¨ Ø¨Ø§Ù„Ø³ÙƒØ±ØŸ', category: 'medical_conditions', followup: 'diabetes' },
  { id: 'Q10', en: 'For women only: are you pregnant now?', ar: 'Ù„Ù„Ø³ÙŠØ¯Ø§Øª ÙÙ‚Ø·: Ù‡Ù„ Ø£Ù†ØªÙ Ø­Ø§Ù…Ù„ Ø§Ù„Ø¢Ù†ØŸ', category: 'female_specific', gender: 'female' },
  { id: 'Q11', en: 'For women only: have you ever been pregnant (even if it did not continue)?', ar: 'Ù„Ù„Ø³ÙŠØ¯Ø§Øª ÙÙ‚Ø·: Ù‡Ù„ Ø³Ø¨Ù‚ Ù„Ùƒ Ø§Ù„Ø­Ù…Ù„ (Ø­ØªÙ‰ ÙˆÙ„Ùˆ Ù„Ù… ÙŠÙƒØªÙ…Ù„)ØŸ', category: 'female_specific', gender: 'female', followup: 'pregnancy' },
  
  // Medications and Vaccinations
  { id: 'Q12', en: 'Are you currently taking any medications?', ar: 'Ù‡Ù„ ØªØ³ØªØ®Ø¯Ù… Ø£ÙŠ Ø£Ø¯ÙˆÙŠØ© Ø­Ø§Ù„ÙŠØ§ØŸ', category: 'medications' },
  { id: 'Q13', en: 'Have you taken any medications on the Medication Deferral List in the time frames indicated? (Review the attached Medication Deferral List)', ar: 'Ù‡Ù„ ØªØ³ØªØ®Ø¯Ù… Ø­Ø§Ù„ÙŠØ§ Ø£Ùˆ Ø³Ø¨Ù‚ Ø£Ù† Ø§Ø³ØªØ®Ø¯Ù…Øª Ø£ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø© Ø®Ù„Ø§Ù„ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø£Ù…Ø§Ù… ÙƒÙ„ Ø¯ÙˆØ§Ø¡ØŸ', category: 'medications', followup: 'medication', reference: 'medication' },
  { id: 'Q14', en: 'In the past 8 weeks, have you had any vaccinations or other shots?', ar: 'Ù‡Ù„ ØªÙ„Ù‚ÙŠØª Ø£ÙŠ Ù„Ù‚Ø§Ø­Ø§Øª (ØªØ·Ø¹ÙŠÙ…Ø§Øª) Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¨ Ø£Ø³Ø§Ø¨ÙŠØ¹ØŸ', category: 'vaccinations', followup: 'vaccine' },
  { id: 'Q15', en: 'In the past 8 weeks, have you had contact with someone who was vaccinated for smallpox in the past 8 weeks?', ar: 'ÙÙŠ Ø¢Ø®Ø± Ù¨ Ø£Ø³Ø§Ø¨ÙŠØ¹ Ù‡Ù„ Ø®Ø§Ù„Ø·Øª Ø´Ø®ØµØ§ ØªÙ„Ù‚Ù‰ Ù„Ù‚Ø§Ø­ Ø§Ù„Ø¬Ø¯Ø±ÙŠ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¨ Ø£Ø³Ø§Ø¨ÙŠØ¹ØŸ', category: 'vaccinations', followup: 'smallpox' },
  
  // Blood and Components Donation
  { id: 'Q16', en: 'In the past 8 weeks, have you donated blood, platelets, or plasma?', ar: 'Ù‡Ù„ ØªØ¨Ø±Ø¹Øª Ø¨Ø§Ù„Ø¯Ù… Ø£Ùˆ Ø¨Ø§Ù„ØµÙØ§Ø¦Ø­ Ø£Ùˆ Ø§Ù„Ø¨Ù„Ø§Ø²Ù…Ø§ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¨ Ø£Ø³Ø§Ø¨ÙŠØ¹ØŸ', category: 'donation_history' },
  { id: 'Q17', en: 'In the past 16 weeks, have you donated a double unit of red blood cells using an apheresis machine?', ar: 'Ù‡Ù„ ØªØ¨Ø±Ø¹Øª Ø¨ÙˆØ­Ø¯ØªÙŠÙ† Ù…Ù† ÙƒØ±ÙŠØ§Øª Ø§Ù„Ø¯Ù… Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¬Ù‡Ø§Ø² ÙØµÙ„ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¡Ù¦ Ø£Ø³Ø¨ÙˆØ¹ØŸ', category: 'donation_history' },
  
  // Exposure to blood and sexual contact
  { id: 'Q18', en: 'Have you ever had a positive test for hepatitis B or C viruses?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† Ø£Ø¬Ø±ÙŠ Ù„Ùƒ ØªØ­Ù„ÙŠÙ„ Ù„Ù„ÙÙŠØ±ÙˆØ³Ø§Øª Ø§Ù„ÙƒØ¨Ø¯ÙŠØ© Ø¨ Ø£Ùˆ Ø¬ ÙˆÙƒØ§Ù†Øª Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© (ØºÙŠØ± Ø³Ù„ÙŠÙ…Ø©)ØŸ', category: 'infections' },
  { id: 'Q19', en: 'In the past 6 months, have you had sexual contact with a person who has hepatitis?', ar: 'Ù‡Ù„ ÙƒØ§Ù† Ù„Ùƒ Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ù…Ø¹ Ø´Ø®Øµ Ù…ØµØ§Ø¨ Ø¨Ø§Ù„ØªÙ‡Ø§Ø¨ Ø§Ù„ÙƒØ¨Ø¯ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'exposure' },
  { id: 'Q20', en: 'In the past 6 months, have you lived with a person who has hepatitis?', ar: 'Ù‡Ù„ Ø¹Ø´Øª ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ù†Ø²Ù„ Ù…Ø¹ Ø´Ø®Øµ Ù…ØµØ§Ø¨ Ø¨Ø§Ù„ØªÙ‡Ø§Ø¨ Ø§Ù„ÙƒØ¨Ø¯ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'exposure' },
  { id: 'Q21', en: 'In the past 3 months, have you had syphilis or gonorrhea or been treated for syphilis or gonorrhea?', ar: 'Ù‡Ù„ Ø´ÙØ®ØµØª Ø¨Ù…Ø±Ø¶ Ø§Ù„Ø²Ù‡Ø±ÙŠ Ø£Ùˆ Ø§Ù„Ø³ÙŠÙ„Ø§Ù† Ø£Ùˆ Ø¬Ø±Ù‰ Ø¹Ù„Ø§Ø¬Ùƒ Ù…Ù†Ù‡Ù…Ø§ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù£ Ø£Ø´Ù‡Ø±ØŸ', category: 'infections' },
  { id: 'Q22', en: 'Have you ever had a positive test result for HIV infection?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† Ø£Ø¬Ø±ÙŠ Ù„Ùƒ ØªØ­Ù„ÙŠÙ„ Ù„ÙÙŠØ±ÙˆØ³ Ù†Ù‚Øµ Ø§Ù„Ù…Ù†Ø§Ø¹Ø© Ø§Ù„Ù…ÙƒØªØ³Ø¨ (Ø§Ù„Ø¥ÙŠØ¯Ø²) ÙˆÙƒØ§Ù†Øª Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© (ØºÙŠØ± Ø³Ù„ÙŠÙ…Ø©)ØŸ', category: 'infections' },
  { id: 'Q23', en: 'Have you ever taken any medication to treat HIV infection?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ ÙˆØ§Ø³ØªØ®Ø¯Ù…Øª Ø¹Ù„Ø§Ø¬Ø§ Ù„Ù…Ø±Ø¶ Ù†Ù‚Øµ Ø§Ù„Ù…Ù†Ø§Ø¹Ø© Ø§Ù„Ù…ÙƒØªØ³Ø¨ (Ø§Ù„Ø¥ÙŠØ¯Ø²)ØŸ', category: 'medications' },
  { id: 'Q24', en: 'Have you ever received any medication orally or by injection to prevent HIV infection? (i.e. PrEP or PEP)', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ ÙˆØ§Ø³ØªØ®Ø¯Ù…Øª Ø¯ÙˆØ§Ø¡ ÙˆÙ‚Ø§Ø¦ÙŠØ§ Ù„Ù…Ù†Ø¹ Ø§Ù„Ø¥ØµØ§Ø¨Ø© Ø¨ÙÙŠØ±ÙˆØ³ Ù†Ù‚Øµ Ø§Ù„Ù…Ù†Ø§Ø¹Ø© Ø§Ù„Ù…ÙƒØªØ³Ø¨ (Ø§Ù„Ø¥ÙŠØ¯Ø²) Ø³ÙˆØ§Ø¡ Ø¨Ø§Ù„ÙÙ… Ø£Ùˆ Ø§Ù„Ø¥Ø¨Ø±ØŸ', category: 'medications' },
  { id: 'Q25', en: 'Have you ever had any sexual contact with a person outside of marriage?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† ÙƒØ§Ù†Øª Ù„Ùƒ Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ù…Ø¹ Ø£ÙŠ Ø´Ø®Øµ Ø®Ø§Ø±Ø¬ Ø¥Ø·Ø§Ø± Ø§Ù„Ø²ÙˆØ§Ø¬ØŸ', category: 'sexual_history' },
  { id: 'Q26', en: 'Have you ever had sexual contact with a person of the same gender?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† ÙƒØ§Ù†Øª Ù„Ùƒ Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ù…Ø«Ù„ÙŠØ© (Ù…Ø¹ Ø´Ø®Øµ Ù…Ù† Ù†ÙØ³ Ø§Ù„Ø¬Ù†Ø³) ÙÙŠ Ø£ÙŠ ÙˆÙ‚ØªØŸ', category: 'sexual_history' },
  { id: 'Q27', en: 'In the past 12 months, have you had any sexual contact with a person with whom you have a marriage contract not documented in Saudi Arabia or another country?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† ÙƒØ§Ù†Øª Ù„Ùƒ Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ù…Ø¹ Ø£ÙŠ Ø´Ø®Øµ Ø¨Ø¹Ù‚Ø¯ Ø²ÙˆØ§Ø¬ ØºÙŠØ± Ù…ÙˆØ«Ù‚ Ø¨Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø£Ùˆ Ø®Ø§Ø±Ø¬Ù‡Ø§ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¡Ù¢ Ø´Ù‡Ø±Ø§Ù‹ØŸ', category: 'sexual_history' },
  { id: 'Q28', en: 'In the past 6 months, have you had sexual contact with anyone who has ever had a positive test result for HIV infection?', ar: 'Ù‡Ù„ ÙƒØ§Ù†Øª Ù„Ùƒ Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø± Ù…Ø¹ Ø´Ø®Øµ Ù…ØµØ§Ø¨ Ø¨ÙÙŠØ±ÙˆØ³ Ù†Ù‚Øµ Ø§Ù„Ù…Ù†Ø§Ø¹Ø© Ø§Ù„Ù…ÙƒØªØ³Ø¨/Ø§Ù„Ø¥ÙŠØ¯Ø² Ø£Ùˆ ÙƒØ§Ù†Øª Ù†ØªÙŠØ¬Ø© Ø§Ø®ØªØ¨Ø§Ø± Ù‡Ø°Ø§ Ø§Ù„ÙÙŠØ±ÙˆØ³ Ù„Ø¯ÙŠÙ‡ Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ© (ØºÙŠØ± Ø³Ù„ÙŠÙ…Ø©)ØŸ', category: 'sexual_history' },
  { id: 'Q29', en: 'Have you ever received money, drugs, or other payment for sex?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† ØªÙ„Ù‚ÙŠØª Ù…Ù‚Ø§Ø¨Ù„Ø§ Ù…Ø§Ø¯ÙŠØ§ Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ©ØŸ', category: 'sexual_history' },
  { id: 'Q30', en: 'Have you ever had sexual contact with anyone who has ever received money, drugs, or other payment for sex?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† ÙƒØ§Ù†Øª Ù„Ùƒ Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ù…Ø¹ Ø£ÙŠ Ø´Ø®Øµ ØªÙ„Ù‚Ù‰ Ù…Ù‚Ø§Ø¨Ù„Ø§ Ù…Ø§Ø¯ÙŠØ§ Ù„Ù„Ø¬Ù†Ø³ØŸ', category: 'sexual_history' },
  { id: 'Q31', en: 'Have you ever used needles to inject drugs, steroids, or other substances not prescribed by your doctor?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ù„Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø¨Ø± Ù„Ø£Ø®Ø° Ø£ÙŠ Ø£Ø¯ÙˆÙŠØ© Ù„Ù… ÙŠØµÙÙ‡Ø§ Ù„Ùƒ Ø§Ù„Ø·Ø¨ÙŠØ¨ (Ø¨Ù…Ø§ ÙÙŠÙ‡Ø§ Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†Ø§Øª Ø£Ùˆ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…Ø®Ø¯Ø±Ø©)ØŸ', category: 'drug_use' },
  { id: 'Q32', en: 'In the past 6 months, have you had sexual contact with anyone who has used needles in the past 6 months to inject drugs, steroids, or anything not prescribed by their doctor?', ar: 'Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŒ Ù‡Ù„ ÙƒØ§Ù† Ù„Ùƒ Ø¹Ù„Ø§Ù‚Ø© Ø¬Ù†Ø³ÙŠØ© Ù…Ø¹ Ø´Ø®Øµ Ù‚Ø§Ù… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø¨Ø± Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø± Ù„Ø£Ø®Ø° Ø£ÙŠ Ø£Ø¯ÙˆÙŠØ© Ù„Ù… ÙŠØµÙÙ‡Ø§ Ù„Ù‡ Ø§Ù„Ø·Ø¨ÙŠØ¨ (Ø¨Ù…Ø§ ÙÙŠÙ‡Ø§ Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†Ø§Øª Ø£Ùˆ Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…Ø®Ø¯Ø±Ø©)ØŸ', category: 'sexual_history' },
  { id: 'Q33', en: 'In the past 6 months, have you had an accidental needle-stick?', ar: 'Ù‡Ù„ ØªØ¹Ø±Ø¶Øª Ù„Ø­Ø§Ø¯Ø« ÙˆØ®Ø² Ø¨Ø¥Ø¨Ø±Ø© Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'exposure' },
  { id: 'Q34', en: 'In the past 6 months, have you come into contact with someone else\'s blood?', ar: 'Ù‡Ù„ Ù„Ø§Ù…Ø³Øª Ø¯Ù… Ø´Ø®ØµÙ Ø¢Ø®Ø± Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'exposure', followup: 'blood_contact' },
  { id: 'Q35', en: 'In the past 6 months, have you had a tattoo or any cosmetic procedure involving needles?', ar: 'Ù‡Ù„ Ø£ÙØ¬Ø±ÙŠØª Ù„Ùƒ Ø¹Ù…Ù„ÙŠØ© ÙˆØ´Ù… Ø£Ùˆ Ø£ÙŠ Ø¥Ø¬Ø±Ø§Ø¡ ØªØ¬Ù…ÙŠÙ„ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø¨Ø± Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'exposure' },
  { id: 'Q36', en: 'In the past 6 months, have you had an ear or a body piercing?', ar: 'Ù‡Ù„ Ø£ÙØ¬Ø±ÙŠØª Ù„Ùƒ Ø¹Ù…Ù„ÙŠØ© Ø«Ù‚Ø¨ ÙÙŠ Ø§Ù„Ø£Ø°Ù† Ø£Ùˆ Ø£ÙŠ Ù…ÙƒØ§Ù† ÙÙŠ Ø§Ù„Ø¬Ø³Ù… Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'exposure' },
  { id: 'Q37', en: 'In the past 6 months, have you had hijama (wet cupping)?', ar: 'Ù‡Ù„ Ø£ÙØ¬Ø±ÙŠØª Ù„Ùƒ Ø­Ø¬Ø§Ù…Ø© Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'exposure' },
  { id: 'Q38', en: 'In the past 6 months, have you had a blood transfusion?', ar: 'Ù‡Ù„ ØªÙ… Ù†Ù‚Ù„ Ø¯Ù… Ù„Ùƒ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'exposure' },
  { id: 'Q39', en: 'In the past 6 months, have you had a graft such as bone or skin?', ar: 'Ù‡Ù„ ØªÙ„Ù‚ÙŠØª Ø±Ù‚Ø¹Ø© Ø¬Ù„Ø¯ÙŠØ© Ø£Ùˆ Ø¹Ø¸Ù…ÙŠØ© Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¦ Ø£Ø´Ù‡Ø±ØŸ', category: 'medical_procedures' },
  { id: 'Q40', en: 'In the past 12 months, have you been in juvenile detention, lockup, jail, or prison for 72 hours or more consecutively?', ar: 'Ù‡Ù„ Ø¬Ø±Ù‰ Ø¥ÙŠÙ‚Ø§ÙÙƒ ÙÙŠ Ø³Ø¬Ù† Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø£Ùˆ Ø§Ù„ØªÙˆÙ‚ÙŠÙ Ø£Ùˆ Ø§Ù„Ø³Ø¬Ù† Ø§Ù„Ø¹Ø§Ø¯ÙŠ Ù„Ù…Ø¯Ø© Ù§Ù¢ Ø³Ø§Ø¹Ø© Ø£Ùˆ Ø£ÙƒØ«Ø± Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¡Ù¢ Ø´Ù‡Ø±Ø§ØŸ', category: 'exposure' },
  
  // Additional Questions (Various diseases and health issues)
  { id: 'Q41', en: 'Have you been outside Saudi Arabia in the past 3 years?', ar: 'Ù‡Ù„ Ø³Ø§ÙØ±Øª Ø£Ùˆ Ø¹Ø´Øª Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù£ Ø³Ù†ÙˆØ§ØªØŸ', category: 'travel', followup: 'travel', reference: 'travel' },
  { id: 'Q42', en: 'Have you visited or lived in a malaria endemic area (within or outside Saudi Arabia) in the past 3 years?', ar: 'Ù‡Ù„ Ø³Ø§ÙØ±Øª Ø£Ùˆ Ø¹Ø´Øª ÙÙŠ Ù…Ù†Ø·Ù‚Ø© Ù…ÙˆØ¨ÙˆØ¡Ø© Ø¨Ø§Ù„Ù…Ù„Ø§Ø±ÙŠØ§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø£Ùˆ Ø®Ø§Ø±Ø¬Ù‡Ø§ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù£ Ø³Ù†ÙˆØ§ØªØŸ', category: 'travel', followup: 'malaria', reference: 'malaria' },
  { id: 'Q43', en: 'Have you ever had malaria?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† Ø£ØµØ¨Øª Ø¨Ø§Ù„Ù…Ù„Ø§Ø±ÙŠØ§ØŸ', category: 'infections' },
  { id: 'Q44', en: 'Have you ever had brucellosis (Malta fever)?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† Ø´ÙØ®ØµØª Ø¨Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠÙ„Ø§ (Ø§Ù„Ø­Ù…Ù‰ Ø§Ù„Ù…Ø§Ù„Ø·ÙŠØ©)ØŸ', category: 'infections' },
  { id: 'Q45', en: 'Have you consumed raw or unpasteurized milk or dairy products in the past 2 months?', ar: 'Ù‡Ù„ ØªÙ†Ø§ÙˆÙ„Øª Ø­Ù„ÙŠØ¨Ø§ Ø£Ùˆ Ù…Ø´ØªÙ‚Ø§Øª Ø­Ù„ÙŠØ¨ Ø·Ø§Ø²Ø¬Ø© ØºÙŠØ± Ù…Ø¹Ù‚Ù…Ø©/ØºÙŠØ± Ù…Ø¨Ø³ØªØ±Ø© Ø®Ù„Ø§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠÙ† Ø§Ù„Ù…Ø§Ø¶ÙŠÙŠÙ†ØŸ', category: 'exposure' },
  { id: 'Q46', en: 'Have you had dengue virus infection in the past 4 months?', ar: 'Ù‡Ù„ Ø´ÙØ®ØµØª Ø¨Ø­Ù…Ù‰ Ø§Ù„Ø¶Ù†Ùƒ Ø®Ù„Ø§Ù„ Ø¢Ø®Ø± Ù¤ Ø£Ø´Ù‡Ø±ØŸ', category: 'infections' },
  { id: 'Q47', en: 'Have you ever had a positive test result for Babesia?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† Ø´ÙØ®ØµØª Ø¨Ø¯Ø§Ø¡ Ø§Ù„Ø¨Ø§Ø¨Ø³ÙŠØ§Øª BabesiosisØŸ', category: 'infections' },
  { id: 'Q48', en: 'Have you ever had Chagas disease?', ar: 'Ù‡Ù„ Ø³Ø¨Ù‚ Ø£Ù† Ø´ÙØ®ØµØª Ø¨Ø¯Ø§Ø¡ Ø´Ø§ØºØ§Ø³ (Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø«Ù‚Ø¨ÙŠÙ‘Ø§Øª Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠ)ØŸ', category: 'infections' },
  { id: 'Q49', en: 'Have you ever been to Mexico, countries of Central America or South America?', ar: 'Ù‡Ù„ Ø²Ø±Øª Ø£Ùˆ Ø¹Ø´Øª ÙÙŠ Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ Ø£Ùˆ Ø¯ÙˆÙ„ Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„ÙˆØ³Ø·Ù‰ Ø£Ùˆ Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©ØŸ', category: 'travel' },
  { id: 'Q50', en: 'Were you or your mother born in Mexico, countries of Central America or South America?', ar: 'Ù‡Ù„ ÙˆÙ„Ø¯Øª Ø£Ù†Øª Ø£Ùˆ ÙˆØ§Ù„Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ Ø£Ùˆ Ø¯ÙˆÙ„ Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„ÙˆØ³Ø·Ù‰ Ø£Ùˆ Ø£Ù…Ø±ÙŠÙƒØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©ØŸ', category: 'travel' },
  { id: 'Q51', en: 'Have you ever had brain surgery?', ar: 'Ù‡Ù„ Ø£Ø¬Ø±ÙŠØª Ù„Ùƒ Ø¹Ù…Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù…Ø®ØŸ', category: 'medical_procedures' },
  { id: 'Q52', en: 'Have you had a transplantation of an organ or tissue or cells (such as bone marrow or stem cells)?', ar: 'Ù‡Ù„ ØªÙ„Ù‚ÙŠØª Ø²Ø±Ø§Ø¹Ø© Ø£ÙŠ Ø¹Ø¶Ùˆ Ø£Ùˆ Ù†Ø³ÙŠØ¬ Ø£Ùˆ Ø®Ù„Ø§ÙŠØ§ (Ù…Ø«Ù„: Ù†Ø®Ø§Ø¹ Ø§Ù„Ø¹Ø¸Ù… Ø£Ùˆ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø¬Ø°Ø¹ÙŠØ©)ØŸ', category: 'medical_procedures' },
];

// External Link Component that opens in new tab
function ExtLink({ href, children, className = "" }) {
  const handleClick = (e) => {
    e.preventDefault();
    window.open(href, '_blank', 'noopener,noreferrer');
  };
  
  return (
    <a 
      href={href} 
      onClick={handleClick}
      className={`inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 hover:underline cursor-pointer ${className}`}
    >
      {children}
      <ExternalLink className="w-3 h-3" />
    </a>
  );
}

// Medication List Component - Expandable dropdown
function MedicationList({ language }) {
  const [expanded, setExpanded] = useState(false);
  const [expandedCategory, setExpandedCategory] = useState(null);

  const medications = [
    {
      category: { en: 'Platelet Inhibitors', ar: 'Ù…Ø«Ø¨Ø·Ø§Øª Ø§Ù„ØµÙØ§Ø¦Ø­ Ø§Ù„Ø¯Ù…ÙˆÙŠØ©' },
      items: [
        { name: 'Aspirin', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Piroxicam (Feldene)', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Prasugrel (Effient)', deferral: { en: '3 days', ar: 'Ù£ Ø£ÙŠØ§Ù…' } },
        { name: 'Ticagrelor (Brilinta)', deferral: { en: '7 days', ar: 'Ù§ Ø£ÙŠØ§Ù…' } },
        { name: 'Clopidogrel (Plavix)', deferral: { en: '14 days', ar: 'Ù¡Ù¤ ÙŠÙˆÙ…' } },
        { name: 'Ticlopidine (Ticlid)', deferral: { en: '14 days', ar: 'Ù¡Ù¤ ÙŠÙˆÙ…' } },
        { name: 'Vorapaxar (Zontivity)', deferral: { en: '1 month', ar: 'Ø´Ù‡Ø±' } },
      ]
    },
    {
      category: { en: 'Anticoagulants', ar: 'Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„ØªØ®Ø«Ø±' },
      items: [
        { name: 'Fondaparinux (Arixtra)', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Apixaban (Eliquis)', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Rivaroxaban (Xarelto)', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Dabigatran (Pradaxa)', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Edoxaban (Savaysa)', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Enoxaparin (Lovenox)', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Dalteparin (Fragmin)', deferral: { en: '2 days', ar: 'Ù¢ ÙŠÙˆÙ…' } },
        { name: 'Warfarin (Coumadin)', deferral: { en: '7 days', ar: 'Ù§ Ø£ÙŠØ§Ù…' } },
        { name: 'Heparin / LMWH', deferral: { en: '7 days', ar: 'Ù§ Ø£ÙŠØ§Ù…' } },
      ]
    },
    {
      category: { en: 'Teratogenic Medications', ar: 'Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…Ø³Ø¨Ø¨Ø© Ù„Ù„ØªØ´ÙˆÙ‡Ø§Øª' },
      items: [
        { name: 'Isotretinoin (Accutane/Roaccutane)', deferral: { en: '1 month', ar: 'Ø´Ù‡Ø±' } },
        { name: 'Finasteride (Propecia/Proscar)', deferral: { en: '1 month', ar: 'Ø´Ù‡Ø±' } },
        { name: 'Dutasteride (Avodart)', deferral: { en: '6 months', ar: 'Ù¦ Ø£Ø´Ù‡Ø±' } },
        { name: 'Acitretin (Soriatane)', deferral: { en: '3 years', ar: 'Ù£ Ø³Ù†ÙˆØ§Øª' } },
        { name: 'Etretinate (Tegison)', deferral: { en: 'Permanent', ar: 'Ø¯Ø§Ø¦Ù…' } },
      ]
    },
    {
      category: { en: 'Immunosuppressants', ar: 'Ù…Ø«Ø¨Ø·Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø¹Ø©' },
      items: [
        { name: 'Thalidomide / Lenalidomide', deferral: { en: '1 month', ar: 'Ø´Ù‡Ø±' } },
        { name: 'Teriflunomide (Aubagio)', deferral: { en: '24 months', ar: 'Ù¢Ù¤ Ø´Ù‡Ø±' } },
        { name: 'Leflunomide (Arava)', deferral: { en: '24 months', ar: 'Ù¢Ù¤ Ø´Ù‡Ø±' } },
        { name: 'Mycophenolate (Cellcept)', deferral: { en: '6 weeks', ar: 'Ù¦ Ø£Ø³Ø§Ø¨ÙŠØ¹' } },
        { name: 'Upadacitinib (Rinvoq)', deferral: { en: '1 month', ar: 'Ø´Ù‡Ø±' } },
      ]
    },
    {
      category: { en: 'Cancer Medications', ar: 'Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ø³Ø±Ø·Ø§Ù†' },
      items: [
        { name: 'Vismodegib (Erivedge)', deferral: { en: '24 months', ar: 'Ù¢Ù¤ Ø´Ù‡Ø±' } },
        { name: 'Sonidegib (Odomzo)', deferral: { en: '24 months', ar: 'Ù¢Ù¤ Ø´Ù‡Ø±' } },
      ]
    },
    {
      category: { en: 'HIV Prevention & Treatment', ar: 'Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† ÙÙŠØ±ÙˆØ³ Ù†Ù‚Øµ Ø§Ù„Ù…Ù†Ø§Ø¹Ø© ÙˆØ¹Ù„Ø§Ø¬Ù‡' },
      items: [
        { name: 'Oral PrEP/PEP (Truvada, Descovy)', deferral: { en: '6 months', ar: 'Ù¦ Ø£Ø´Ù‡Ø±' } },
        { name: 'Injectable PrEP (Cabotegravir/Apretude)', deferral: { en: '24 months', ar: 'Ù¢Ù¤ Ø´Ù‡Ø±' } },
        { name: 'ART (HIV Treatment)', deferral: { en: 'Permanent', ar: 'Ø¯Ø§Ø¦Ù…' } },
      ]
    },
    {
      category: { en: 'Other Medications', ar: 'Ø£Ø¯ÙˆÙŠØ© Ø£Ø®Ø±Ù‰' },
      items: [
        { name: 'Antibiotics / Antivirals / Antifungals', deferral: { en: '1 month after completion', ar: 'Ø´Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡' } },
        { name: 'HBIG (Hepatitis B Immune Globulin)', deferral: { en: '6 months', ar: 'Ù¦ Ø£Ø´Ù‡Ø±' } },
        { name: 'Experimental Medications/Vaccines', deferral: { en: '12 months', ar: 'Ù¡Ù¢ Ø´Ù‡Ø±' } },
      ]
    },
  ];

  return (
    <div className="border border-amber-200 rounded-xl overflow-hidden bg-amber-50">
      <button
        onClick={() => setExpanded(!expanded)}
        className="w-full px-4 py-3 flex items-center justify-between bg-amber-100 hover:bg-amber-200 transition-colors"
      >
        <div className="flex items-center gap-2">
          <FileText className="w-5 h-5 text-amber-700" />
          <span className="font-medium text-amber-800">
            {language === 'en' ? 'View Medication Deferral List' : 'Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¯ÙˆÙŠØ© Ø§Ù„Ù…Ø¤Ø¬Ù„Ø©'}
          </span>
        </div>
        <ChevronRight className={`w-5 h-5 text-amber-600 transition-transform ${expanded ? 'rotate-90' : ''}`} />
      </button>
      
      {expanded && (
        <div className="p-3 max-h-80 overflow-y-auto">
          <p className="text-xs text-amber-700 mb-3 px-1">
            {language === 'en' 
              ? 'Click on a category to see medications and their deferral periods:' 
              : 'Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ ÙØ¦Ø© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ÙˆÙØªØ±Ø§Øª Ø§Ù„ØªØ£Ø¬ÙŠÙ„:'}
          </p>
          <div className="space-y-2">
            {medications.map((cat, idx) => (
              <div key={idx} className="border border-amber-200 rounded-lg overflow-hidden bg-white">
                <button
                  onClick={() => setExpandedCategory(expandedCategory === idx ? null : idx)}
                  className="w-full px-3 py-2 flex items-center justify-between hover:bg-amber-50 transition-colors"
                >
                  <span className="font-medium text-sm text-gray-700">
                    {language === 'en' ? cat.category.en : cat.category.ar}
                  </span>
                  <div className="flex items-center gap-2">
                    <span className="text-xs text-gray-400">{cat.items.length}</span>
                    <ChevronRight className={`w-4 h-4 text-gray-400 transition-transform ${expandedCategory === idx ? 'rotate-90' : ''}`} />
                  </div>
                </button>
                {expandedCategory === idx && (
                  <div className="border-t border-amber-100 bg-gray-50">
                    {cat.items.map((med, midx) => (
                      <div key={midx} className="px-3 py-2 flex justify-between items-center text-sm border-b border-gray-100 last:border-b-0">
                        <span className="text-gray-700">{med.name}</span>
                        <span className="text-red-600 font-medium text-xs bg-red-50 px-2 py-0.5 rounded">
                          {language === 'en' ? med.deferral.en : med.deferral.ar}
                        </span>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}

// Vaccine List Component - Expandable dropdown
function VaccineList({ language }) {
  const [expanded, setExpanded] = useState(false);
  const [expandedCategory, setExpandedCategory] = useState(null);

  const vaccines = [
    {
      category: { en: 'No Deferral Required', ar: 'Ù„Ø§ ÙŠØªØ·Ù„Ø¨ ØªØ£Ø¬ÙŠÙ„' },
      items: [
        { name: 'COVID-19 (mRNA/non-replicating: Pfizer, Moderna, J&J)', deferral: { en: 'No deferral', ar: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯' } },
        { name: 'Jynneos (Smallpox/Mpox - non-replicating)', deferral: { en: 'No deferral', ar: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯' } },
        { name: 'Toxoids/Killed vaccines (if symptom-free)', deferral: { en: 'No deferral', ar: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯' } },
        { name: 'Recombinant vaccines (HPV, Shingrix)', deferral: { en: 'No deferral', ar: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯' } },
        { name: 'Intranasal flu (live attenuated)', deferral: { en: 'No deferral', ar: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯' } },
        { name: 'Vaxchora (oral cholera)', deferral: { en: 'No deferral', ar: 'Ù„Ø§ ÙŠÙˆØ¬Ø¯' } },
      ]
    },
    {
      category: { en: '2-Week Deferral', ar: 'ØªØ£Ø¬ÙŠÙ„ Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†' },
      items: [
        { name: 'Measles', deferral: { en: '2 weeks', ar: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†' } },
        { name: 'Mumps', deferral: { en: '2 weeks', ar: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†' } },
        { name: 'Polio (oral)', deferral: { en: '2 weeks', ar: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†' } },
        { name: 'Typhoid (oral)', deferral: { en: '2 weeks', ar: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†' } },
        { name: 'Yellow fever', deferral: { en: '2 weeks', ar: 'Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†' } },
        { name: 'COVID-19 (live attenuated)', deferral: { en: '14 days', ar: 'Ù¡Ù¤ ÙŠÙˆÙ…' } },
        { name: 'COVID-19 (unknown type)', deferral: { en: '14 days', ar: 'Ù¡Ù¤ ÙŠÙˆÙ…' } },
      ]
    },
    {
      category: { en: '4-Week Deferral', ar: 'ØªØ£Ø¬ÙŠÙ„ Ù¤ Ø£Ø³Ø§Ø¨ÙŠØ¹' },
      items: [
        { name: 'Rubella (German measles)', deferral: { en: '4 weeks', ar: 'Ù¤ Ø£Ø³Ø§Ø¨ÙŠØ¹' } },
        { name: 'Varicella (Chickenpox)', deferral: { en: '4 weeks', ar: 'Ù¤ Ø£Ø³Ø§Ø¨ÙŠØ¹' } },
      ]
    },
    {
      category: { en: 'Special Assessment', ar: 'ØªÙ‚ÙŠÙŠÙ… Ø®Ø§Øµ' },
      items: [
        { name: 'Smallpox vaccinia (replication competent)', deferral: { en: 'Special assessment required', ar: 'ÙŠØªØ·Ù„Ø¨ ØªÙ‚ÙŠÙŠÙ… Ø®Ø§Øµ' } },
        { name: 'Experimental vaccines', deferral: { en: '12 months', ar: 'Ù¡Ù¢ Ø´Ù‡Ø±' } },
      ]
    },
  ];

  return (
    <div className="border border-green-200 rounded-xl overflow-hidden bg-green-50">
      <button
        onClick={() => setExpanded(!expanded)}
        className="w-full px-4 py-3 flex items-center justify-between bg-green-100 hover:bg-green-200 transition-colors"
      >
        <div className="flex items-center gap-2">
          <FileText className="w-5 h-5 text-green-700" />
          <span className="font-medium text-green-800">
            {language === 'en' ? 'View Vaccine Deferral List' : 'Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù„Ù‚Ø§Ø­Ø§Øª Ø§Ù„Ù…Ø¤Ø¬Ù„Ø©'}
          </span>
        </div>
        <ChevronRight className={`w-5 h-5 text-green-600 transition-transform ${expanded ? 'rotate-90' : ''}`} />
      </button>
      
      {expanded && (
        <div className="p-3 max-h-80 overflow-y-auto">
          <p className="text-xs text-green-700 mb-3 px-1">
            {language === 'en' 
              ? 'Click on a category to see vaccines and their deferral periods:' 
              : 'Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ ÙØ¦Ø© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù„Ù‚Ø§Ø­Ø§Øª ÙˆÙØªØ±Ø§Øª Ø§Ù„ØªØ£Ø¬ÙŠÙ„:'}
          </p>
          <div className="space-y-2">
            {vaccines.map((cat, idx) => (
              <div key={idx} className="border border-green-200 rounded-lg overflow-hidden bg-white">
                <button
                  onClick={() => setExpandedCategory(expandedCategory === idx ? null : idx)}
                  className="w-full px-3 py-2 flex items-center justify-between hover:bg-green-50 transition-colors"
                >
                  <span className="font-medium text-sm text-gray-700">
                    {language === 'en' ? cat.category.en : cat.category.ar}
                  </span>
                  <div className="flex items-center gap-2">
                    <span className="text-xs text-gray-400">{cat.items.length}</span>
                    <ChevronRight className={`w-4 h-4 text-gray-400 transition-transform ${expandedCategory === idx ? 'rotate-90' : ''}`} />
                  </div>
                </button>
                {expandedCategory === idx && (
                  <div className="border-t border-green-100 bg-gray-50">
                    {cat.items.map((vac, vidx) => (
                      <div key={vidx} className="px-3 py-2 flex justify-between items-center text-sm border-b border-gray-100 last:border-b-0">
                        <span className="text-gray-700">{vac.name}</span>
                        <span className={`font-medium text-xs px-2 py-0.5 rounded ${
                          vac.deferral.en === 'No deferral' 
                            ? 'text-green-600 bg-green-50' 
                            : 'text-orange-600 bg-orange-50'
                        }`}>
                          {language === 'en' ? vac.deferral.en : vac.deferral.ar}
                        </span>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}

function BloodDonorApp() {
  const [activeTab, setActiveTab] = useState('questionnaire');
  const [language, setLanguage] = useState('en');

  return (
    <div className="min-h-screen bg-gradient-to-br from-rose-50 via-white to-red-50">
      <header className="bg-gradient-to-r from-red-700 via-red-600 to-rose-600 text-white shadow-lg sticky top-0 z-50">
        <div className="max-w-4xl mx-auto px-4 py-4">
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center"><Heart className="w-6 h-6" /></div>
              <div>
                <h1 className="text-lg font-bold">{language === 'en' ? 'Blood Donor Screening' : 'ÙØ­Øµ Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ† Ø¨Ø§Ù„Ø¯Ù…'}</h1>
                <p className="text-xs text-red-100">{language === 'en' ? 'Saudi National Blood Bank' : 'Ø¨Ù†Ùƒ Ø§Ù„Ø¯Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ'}</p>
              </div>
            </div>
            <button onClick={() => setLanguage(language === 'en' ? 'ar' : 'en')} className="flex items-center gap-2 px-3 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-sm">
              <Globe className="w-4 h-4" />{language === 'en' ? 'Ø¹Ø±Ø¨ÙŠ' : 'EN'}
            </button>
          </div>
        </div>
      </header>

      <nav className="bg-white border-b shadow-sm sticky top-[72px] z-40">
        <div className="max-w-4xl mx-auto px-4 flex">
          <button onClick={() => setActiveTab('questionnaire')} className={`flex-1 flex items-center justify-center gap-2 py-3 text-sm font-medium border-b-2 ${activeTab === 'questionnaire' ? 'border-red-600 text-red-700 bg-red-50/50' : 'border-transparent text-gray-500'}`}>
            <FileText className="w-4 h-4" />{language === 'en' ? 'Questionnaire' : 'Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù†'}
          </button>
          <button onClick={() => setActiveTab('database')} className={`flex-1 flex items-center justify-center gap-2 py-3 text-sm font-medium border-b-2 ${activeTab === 'database' ? 'border-red-600 text-red-700 bg-red-50/50' : 'border-transparent text-gray-500'}`}>
            <Database className="w-4 h-4" />{language === 'en' ? 'Rules Database' : 'Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯'}
          </button>
        </div>
      </nav>

      <main className="max-w-4xl mx-auto px-4 py-6">
        {activeTab === 'questionnaire' ? <Questionnaire language={language} rules={RULES_DATA.rules} /> : <RulesDatabase language={language} rules={RULES_DATA.rules} metadata={RULES_DATA.metadata} />}
      </main>

      <footer className="bg-gray-800 text-gray-400 py-6 mt-12">
        <div className="max-w-4xl mx-auto px-4 text-center text-sm">
          <p>{language === 'en' ? 'Based on Saudi National DHQ Guidelines' : 'Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ø³ØªØ¨ÙŠØ§Ù† Ø§Ù„Ù…ØªØ¨Ø±Ø¹ÙŠÙ† Ø§Ù„ÙˆØ·Ù†ÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ'}</p>
          <p className="mt-1 text-gray-500">Version {RULES_DATA.metadata.version}</p>
        </div>
      </footer>
    </div>
  );
}

function Questionnaire({ language, rules }) {
  const [step, setStep] = useState('intro');
  const [gender, setGender] = useState(null);
  const [answers, setAnswers] = useState({});
  const [deferrals, setDeferrals] = useState([]);
  const [qIndex, setQIndex] = useState(0);
  const [followup, setFollowup] = useState(null);
  const [travelInfo, setTravelInfo] = useState({ dest: '', date: '' });

  const questions = useMemo(() => gender ? QUESTIONS.filter(q => !q.gender || q.gender === gender) : QUESTIONS, [gender]);
  const currentQ = questions[qIndex];
  const progress = ((qIndex + 1) / questions.length) * 100;

  const addDeferral = (type, days, reason, qId) => {
    if (!type) return;
    setDeferrals(prev => {
      const filtered = prev.filter(d => d.question !== qId);
      return [...filtered, { type, days, reason, question: qId, date: new Date().toISOString() }];
    });
  };

  const removeDeferral = (qId) => {
    setDeferrals(prev => prev.filter(d => d.question !== qId));
  };

  const goToNext = () => {
    setFollowup(null);
    if (qIndex < questions.length - 1) {
      setQIndex(qIndex + 1);
    } else {
      setStep('result');
    }
  };

  const goToPrevious = () => {
    if (followup) {
      setFollowup(null);
      return;
    }
    if (qIndex > 0) {
      setAnswers(prev => {
        const newAnswers = { ...prev };
        delete newAnswers[currentQ.id];
        delete newAnswers[currentQ.id + '_followup'];
        return newAnswers;
      });
      removeDeferral(currentQ.id);
      setQIndex(qIndex - 1);
    } else {
      setStep('requirements');
    }
  };

  const handleAnswer = (answer) => {
    const q = currentQ;
    setAnswers(prev => ({ ...prev, [q.id]: answer }));
    removeDeferral(q.id);

    // Only show followup if YES and question has followup
    if (answer === 'YES' && q.followup) {
      setFollowup(q.followup);
      return;
    }

    // Check for deferrals based on rules
    const rule = rules.find(r => r.question_number === q.id);
    if (rule) {
      const outcome = answer === 'YES' ? rule.outcome_if_yes : rule.outcome_if_no;
      
      // Determine if outcome triggers a deferral
      if (outcome) {
        let deferralType = null;
        let deferralDays = 0;
        
        // Check for explicit DEFER outcomes
        if (outcome === 'DEFER_PERMANENT' || outcome === 'DEFER_INDEFINITE') {
          deferralType = 'permanent';
        } else if (outcome === 'DEFER_DURING_BF') {
          // Breastfeeding - indefinite until breastfeeding ends
          deferralType = 'indefinite';
        } else if (outcome.startsWith('DEFER_')) {
          deferralType = 'temporary';
          // Parse duration from outcome like DEFER_6_MONTHS, DEFER_3_YEARS, etc.
          const match = outcome.match(/DEFER_(\d+)_?(DAYS?|WEEKS?|MONTHS?|YEARS?|[DWMYH])?/i);
          if (match) {
            const num = parseInt(match[1]);
            const unit = (match[2] || '').toUpperCase();
            if (unit.startsWith('H')) deferralDays = Math.ceil(num / 24); // Hours
            else if (unit.startsWith('D')) deferralDays = num;
            else if (unit.startsWith('W')) deferralDays = num * 7;
            else if (unit.startsWith('M')) deferralDays = num * 30;
            else if (unit.startsWith('Y')) deferralDays = num * 365;
            else deferralDays = num; // Default to days
          } else if (rule.deferral_duration && rule.deferral_unit) {
            // Use rule's duration if outcome doesn't specify
            const num = rule.deferral_duration;
            const unit = rule.deferral_unit;
            if (unit === 'hours') deferralDays = Math.ceil(num / 24);
            else if (unit === 'days') deferralDays = num;
            else if (unit === 'weeks') deferralDays = num * 7;
            else if (unit === 'months') deferralDays = num * 30;
            else if (unit === 'years') deferralDays = num * 365;
          }
        } else if (outcome === 'EVALUATE' || outcome === 'EVALUATE_PER_SOP' || 
                   outcome === 'EVALUATE_REASON' || outcome === 'EVALUATE_OUTBREAKS' ||
                   outcome === 'EVALUATE_TRANSPLANT_TYPE' || outcome === 'EVALUATE_UNDERLYING_CONDITION' ||
                   outcome === 'SPECIAL_ASSESSMENT' || outcome === 'TRALI_RESTRICTION' ||
                   outcome === 'ELIGIBLE_PER_PHYSICIAN' || outcome === 'ELIGIBLE_IF_PATHOGEN_REDUCED' ||
                   outcome === 'ASK_TO_EAT' || outcome === 'FINAL_OUTCOME') {
          // Questions requiring physician/staff evaluation should flag for review
          deferralType = 'hold_for_review';
        }
        // Skip outcomes that are workflow indicators (CHECK_, CONTINUE_, BRANCH_) - handled by followup UI
        
        if (deferralType) {
          addDeferral(deferralType, deferralDays, rule.rationale_en, q.id);
        }
      }
    }

    goToNext();
  };

  const handleFollowup = (type, days, reason) => {
    if (type) addDeferral(type, days, reason, currentQ.id);
    goToNext();
  };

  const reset = () => {
    setStep('intro'); 
    setGender(null); 
    setAnswers({}); 
    setDeferrals([]); 
    setQIndex(0); 
    setFollowup(null); 
    setTravelInfo({ dest: '', date: '' });
  };

  const result = useMemo(() => {
    if (!deferrals.length) return { status: 'ELIGIBLE', canDonate: true, deferrals: [] };
    const perm = deferrals.filter(d => d.type === 'permanent');
    const indef = deferrals.filter(d => d.type === 'indefinite');
    const temp = deferrals.filter(d => d.type === 'temporary');
    const review = deferrals.filter(d => d.type === 'hold_for_review');

    if (perm.length) return { status: 'PERMANENTLY_DEFERRED', canDonate: false, deferrals, controlling: perm[0] };
    if (indef.length) return { status: 'INDEFINITELY_DEFERRED', canDonate: false, deferrals, controlling: indef[0] };
    if (temp.length) {
      let maxEnd = null, ctrl = null;
      temp.forEach(d => {
        const end = new Date(d.date);
        end.setDate(end.getDate() + (d.days || 0));
        d.endDate = end;
        if (!maxEnd || end > maxEnd) { maxEnd = end; ctrl = d; }
      });
      return { status: 'TEMPORARILY_DEFERRED', canDonate: false, deferrals, controlling: ctrl, endDate: maxEnd, daysLeft: Math.ceil((maxEnd - new Date()) / 86400000) };
    }
    if (review.length) return { status: 'PENDING_REVIEW', canDonate: false, deferrals, controlling: review[0] };
    return { status: 'ELIGIBLE', canDonate: true, deferrals: [] };
  }, [deferrals]);

  // Intro
  if (step === 'intro') return (
    <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
      <div className="bg-gradient-to-r from-red-600 to-rose-500 p-6 text-white">
        <h2 className="text-xl font-bold mb-2">{language === 'en' ? 'Donor Eligibility Screening' : 'ÙØ­Øµ Ø£Ù‡Ù„ÙŠØ© Ø§Ù„Ù…ØªØ¨Ø±Ø¹'}</h2>
        <p className="text-red-100 text-sm">{language === 'en' ? 'Answer questions to check your eligibility' : 'Ø£Ø¬Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ø£Ù‡Ù„ÙŠØªÙƒ'}</p>
      </div>
      <div className="p-6 space-y-6">
        <div className="bg-amber-50 border border-amber-200 rounded-xl p-4 flex gap-3">
          <AlertTriangle className="w-5 h-5 text-amber-600 flex-shrink-0" />
          <p className="text-sm text-amber-800">{language === 'en' ? 'Please answer all questions accurately as the goal to ensure your safety and the safety of the patient receiving the blood. All answers are kept confidential.' : 'Ù†Ø±Ø¬Ùˆ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¨Ø¯Ù‚Ø© Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø­ÙŠØ« ØªÙ‡Ø¯Ù Ù„Ø¶Ù…Ø§Ù† Ø³Ù„Ø§Ù…ØªÙƒ ÙˆØ³Ù„Ø§Ù…Ø© Ù…Ù† ÙŠØªÙ„Ù‚Ù‰ Ø§Ù„Ø¯Ù…. ØªØ¹Ø§Ù…Ù„ ÙƒÙ„ Ø§Ù„Ø£Ø¬ÙˆØ¨Ø© Ø¨Ø³Ø±ÙŠØ© ØªØ§Ù…Ø©.'}</p>
        </div>
        <div>
          <label className="block text-sm font-medium text-gray-700 mb-2">{language === 'en' ? 'Select your gender:' : 'Ø§Ø®ØªØ± Ø¬Ù†Ø³Ùƒ:'}</label>
          <div className="grid grid-cols-2 gap-3">
            <button onClick={() => setGender('male')} className={`p-4 rounded-xl border-2 transition-all ${gender === 'male' ? 'border-red-500 bg-red-50' : 'border-gray-200 hover:border-red-300'}`}>
              <span className="text-2xl block mb-1">ğŸ‘¨</span><span className="font-medium">{language === 'en' ? 'Male' : 'Ø°ÙƒØ±'}</span>
            </button>
            <button onClick={() => setGender('female')} className={`p-4 rounded-xl border-2 transition-all ${gender === 'female' ? 'border-red-500 bg-red-50' : 'border-gray-200 hover:border-red-300'}`}>
              <span className="text-2xl block mb-1">ğŸ‘©</span><span className="font-medium">{language === 'en' ? 'Female' : 'Ø£Ù†Ø«Ù‰'}</span>
            </button>
          </div>
        </div>
        <button onClick={() => gender && setStep('requirements')} disabled={!gender} className={`w-full py-4 rounded-xl font-semibold text-white transition-all ${gender ? 'bg-gradient-to-r from-red-600 to-rose-500 hover:from-red-700 hover:to-rose-600' : 'bg-gray-300 cursor-not-allowed'}`}>
          {language === 'en' ? 'Continue' : 'Ù…ØªØ§Ø¨Ø¹Ø©'} <ChevronRight className="w-5 h-5 inline ml-2" />
        </button>
      </div>
    </div>
  );

  // Requirements
  if (step === 'requirements') return (
    <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
      <div className="bg-gradient-to-r from-blue-600 to-blue-500 p-6 text-white">
        <div className="flex items-center gap-3 mb-2"><Info className="w-6 h-6" /><h2 className="text-xl font-bold">{language === 'en' ? 'Donation Requirements' : 'Ø´Ø±ÙˆØ· Ø§Ù„ØªØ¨Ø±Ø¹ Ø¨Ø§Ù„Ø¯Ù…'}</h2></div>
        <p className="text-blue-100 text-sm">{language === 'en' ? 'Ensure you meet these criteria before proceeding' : 'ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø³ØªÙŠÙØ§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ù‚Ø¨Ù„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©'}</p>
      </div>
      <div className="p-6">
        <ul className="space-y-2">
          {ELIGIBILITY_REQUIREMENTS.map((r, i) => (
            <li key={i} className="flex items-start gap-3">
              <div className="w-5 h-5 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center flex-shrink-0"><Check className="w-3 h-3" /></div>
              <span className="text-sm text-gray-700" dir={language === 'ar' ? 'rtl' : 'ltr'}>{language === 'en' ? r.en : r.ar}</span>
            </li>
          ))}
        </ul>
        <div className="mt-6 flex gap-3">
          <button onClick={() => setStep('intro')} className="flex-1 py-3 rounded-xl border border-gray-200 text-gray-600 hover:bg-gray-50 transition-all flex items-center justify-center gap-1">
            <ChevronLeft className="w-4 h-4" />{language === 'en' ? 'Back' : 'Ø±Ø¬ÙˆØ¹'}
          </button>
          <button onClick={() => setStep('questions')} className="flex-1 py-3 rounded-xl bg-gradient-to-r from-red-600 to-rose-500 text-white font-semibold hover:from-red-700 hover:to-rose-600 transition-all flex items-center justify-center gap-1">
            {language === 'en' ? 'Begin Questionnaire' : 'Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ¨ÙŠØ§Ù†'} <ChevronRight className="w-5 h-5" />
          </button>
        </div>
      </div>
    </div>
  );

  // Result
  if (step === 'result') return <ResultScreen result={result} language={language} onReset={reset} />;

  // Followup screens
  if (followup) return (
    <FollowupScreen 
      type={followup} 
      language={language} 
      q={currentQ} 
      onSelect={handleFollowup} 
      onBack={() => setFollowup(null)}
      travelInfo={travelInfo} 
      setTravelInfo={setTravelInfo} 
    />
  );

  // Questions
  return (
    <div className="space-y-4">
      {/* Progress Bar */}
      <div className="bg-white rounded-xl p-4 shadow-sm">
        <div className="flex justify-between text-sm text-gray-600 mb-2">
          <span>{language === 'en' ? 'Question' : 'Ø§Ù„Ø³Ø¤Ø§Ù„'} {currentQ?.id}</span>
          <span>{qIndex + 1} / {questions.length}</span>
        </div>
        <div className="h-2 bg-gray-100 rounded-full overflow-hidden">
          <div className="h-full bg-gradient-to-r from-red-500 to-rose-500 transition-all duration-300" style={{ width: `${progress}%` }} />
        </div>
      </div>

      {/* Question Card */}
      {currentQ && (
        <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
          <div className="bg-red-50 px-6 py-3 border-b border-red-100">
            <span className="text-lg font-bold text-red-700">{currentQ.id}</span>
            {currentQ.category && (
              <span className="ml-3 text-xs text-red-500 bg-red-100 px-2 py-1 rounded-full capitalize">
                {currentQ.category.replace(/_/g, ' ')}
              </span>
            )}
          </div>
          <div className="p-6">
            <h3 className="text-lg font-semibold text-gray-800 mb-6" dir={language === 'ar' ? 'rtl' : 'ltr'}>
              {language === 'en' ? currentQ.en : currentQ.ar}
            </h3>
            
            {/* Reference Links */}
            {currentQ.reference && (
              <div className="mb-6">
                {currentQ.reference === 'medication' && (
                  <MedicationList language={language} />
                )}
                {currentQ.reference === 'travel' && (
                  <div className="p-4 bg-blue-50 rounded-xl border border-blue-200">
                    <div className="flex items-start gap-3">
                      <ExternalLink className="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" />
                      <div className="text-sm space-y-2">
                        <p className="text-blue-800 font-medium mb-2">
                          {language === 'en' ? 'Check travel health advisories:' : 'Ø±Ø§Ø¬Ø¹ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª ØµØ­Ø© Ø§Ù„Ø³ÙØ±:'}
                        </p>
                        <div className="space-y-1">
                          <ExtLink href={REFERENCE_LINKS.pha.url}>
                            {language === 'en' ? REFERENCE_LINKS.pha.name : REFERENCE_LINKS.pha.nameAr}
                          </ExtLink>
                          <br />
                          <ExtLink href={REFERENCE_LINKS.moh.url}>
                            {language === 'en' ? REFERENCE_LINKS.moh.name : REFERENCE_LINKS.moh.nameAr}
                          </ExtLink>
                          <br />
                          <ExtLink href={REFERENCE_LINKS.shc.url}>
                            {language === 'en' ? REFERENCE_LINKS.shc.name : REFERENCE_LINKS.shc.nameAr}
                          </ExtLink>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
                {currentQ.reference === 'malaria' && (
                  <div className="p-4 bg-blue-50 rounded-xl border border-blue-200">
                    <div className="flex items-start gap-3">
                      <ExternalLink className="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" />
                      <div className="text-sm">
                        <p className="text-blue-800 font-medium mb-2">
                          {language === 'en' ? 'Check malaria endemic areas:' : 'ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ù„Ø§Ø±ÙŠØ§ Ø§Ù„Ù…ÙˆØ¨ÙˆØ¡Ø©:'}
                        </p>
                        <ExtLink href={REFERENCE_LINKS.cdc_malaria.url}>
                          {language === 'en' ? REFERENCE_LINKS.cdc_malaria.name : REFERENCE_LINKS.cdc_malaria.nameAr}
                        </ExtLink>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* Answer Buttons */}
            <div className="grid grid-cols-2 gap-4">
              <button 
                onClick={() => handleAnswer('YES')} 
                className="flex items-center justify-center gap-2 py-4 rounded-xl bg-green-50 border-2 border-green-200 text-green-700 font-semibold hover:bg-green-100 hover:border-green-300 transition-all"
              >
                <Check className="w-5 h-5" />{language === 'en' ? 'Yes' : 'Ù†Ø¹Ù…'}
              </button>
              <button 
                onClick={() => handleAnswer('NO')} 
                className="flex items-center justify-center gap-2 py-4 rounded-xl bg-red-50 border-2 border-red-200 text-red-700 font-semibold hover:bg-red-100 hover:border-red-300 transition-all"
              >
                <X className="w-5 h-5" />{language === 'en' ? 'No' : 'Ù„Ø§'}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Navigation Buttons */}
      <div className="flex gap-3">
        <button 
          onClick={goToPrevious} 
          className="flex-1 py-3 rounded-xl border border-gray-200 text-gray-600 font-medium hover:bg-gray-50 transition-all flex items-center justify-center gap-2"
        >
          <ChevronLeft className="w-4 h-4" />
          {language === 'en' ? 'Previous' : 'Ø§Ù„Ø³Ø§Ø¨Ù‚'}
        </button>
        {answers[currentQ?.id] && (
          <button 
            onClick={goToNext}
            className="flex-1 py-3 rounded-xl bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition-all flex items-center justify-center gap-2"
          >
            {language === 'en' ? 'Next' : 'Ø§Ù„ØªØ§Ù„ÙŠ'}
            <ChevronRight className="w-4 h-4" />
          </button>
        )}
      </div>

      {/* Deferrals Count */}
      {deferrals.length > 0 && (
        <div className="bg-amber-50 border border-amber-200 rounded-xl p-4 flex items-center gap-3">
          <AlertTriangle className="w-5 h-5 text-amber-600" />
          <span className="text-sm text-amber-800">
            {deferrals.length} {language === 'en' ? 'potential deferral(s) noted' : 'ØªØ£Ø¬ÙŠÙ„(Ø§Øª) Ù…Ø­ØªÙ…Ù„Ø©'}
          </span>
        </div>
      )}

      {/* Reset Button */}
      <button onClick={reset} className="w-full py-3 rounded-xl border border-gray-200 text-gray-600 flex items-center justify-center gap-2 hover:bg-gray-50 transition-all">
        <RefreshCw className="w-4 h-4" />{language === 'en' ? 'Start Over' : 'Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯'}
      </button>
    </div>
  );
}

function FollowupScreen({ type, language, q, onSelect, onBack, travelInfo, setTravelInfo }) {
  const options = {
    dental: [
      { id: 'none', en: 'Ortho wire adjustment, Fluoride, Superficial cleaning, Appliance delivery - No deferral', ar: 'ØªØ¹Ø¯ÙŠÙ„ Ø³Ù„Ùƒ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…ØŒ Ø§Ù„ÙÙ„ÙˆØ±Ø§ÙŠØ¯ØŒ Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø³Ø·Ø­ÙŠ - Ø¨Ø¯ÙˆÙ† ØªØ£Ø¬ÙŠÙ„', days: 0, t: null },
      { id: '24h', en: 'Fillings, Simple root canal, Crown/bridge prep, Ortho band - 24 hours deferral', ar: 'Ø­Ø´ÙˆØ§ØªØŒ Ø¹Ù„Ø§Ø¬ Ø¹ØµØ¨ Ø¨Ø³ÙŠØ·ØŒ ØªØ­Ø¶ÙŠØ± ØªØ§Ø¬/Ø¬Ø³Ø± - ØªØ£Ø¬ÙŠÙ„ Ù¢Ù¤ Ø³Ø§Ø¹Ø©', days: 1, t: 'temporary' },
      { id: '7d', en: 'Extractions, Biopsy, Dental implant, Surgical procedures - 7 days deferral', ar: 'Ø®Ù„Ø¹ØŒ Ø®Ø²Ø¹Ø©ØŒ Ø²Ø±Ø§Ø¹Ø© Ø£Ø³Ù†Ø§Ù†ØŒ Ø¬Ø±Ø§Ø­Ø§Øª - ØªØ£Ø¬ÙŠÙ„ Ù§ Ø£ÙŠØ§Ù…', days: 7, t: 'temporary' },
    ],
    wound: [
      { id: 'healed', en: 'Wound healed, no infection - No deferral', ar: 'Ø§Ù„Ø¬Ø±Ø­ Ø´ÙÙÙŠØŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§Ù„ØªÙ‡Ø§Ø¨ - Ø¨Ø¯ÙˆÙ† ØªØ£Ø¬ÙŠÙ„', days: 0, t: null },
      { id: 'no_abx', en: 'Minor infection, healed without antibiotics - 2 weeks deferral', ar: 'Ø§Ù„ØªÙ‡Ø§Ø¨ Ø¨Ø³ÙŠØ·ØŒ Ø´ÙÙÙŠ Ø¨Ø¯ÙˆÙ† Ù…Ø¶Ø§Ø¯Ø§Øª Ø­ÙŠÙˆÙŠØ© - ØªØ£Ø¬ÙŠÙ„ Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†', days: 14, t: 'temporary' },
      { id: 'abx', en: 'Used oral/IV antibiotics - 4 weeks deferral after completion', ar: 'Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø¶Ø§Ø¯Ø§Øª Ø­ÙŠÙˆÙŠØ© ÙÙ…ÙˆÙŠØ©/ÙˆØ±ÙŠØ¯ÙŠØ© - ØªØ£Ø¬ÙŠÙ„ Ù¤ Ø£Ø³Ø§Ø¨ÙŠØ¹ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡', days: 28, t: 'temporary' },
    ],
    diabetes: [
      { id: 'complications', en: 'Yes, I have dizziness when standing OR foot/leg ulcers - Permanent deferral', ar: 'Ù†Ø¹Ù…ØŒ Ø£Ø¹Ø§Ù†ÙŠ Ù…Ù† Ø¯ÙˆØ®Ø© Ø¹Ù†Ø¯ Ø§Ù„ÙˆÙ‚ÙˆÙ Ø£Ùˆ ØªÙ‚Ø±Ø­Ø§Øª ÙÙŠ Ø§Ù„Ù‚Ø¯Ù… - ØªØ£Ø¬ÙŠÙ„ Ø¯Ø§Ø¦Ù…', days: null, t: 'permanent' },
      { id: 'acute', en: 'Had acute episode in past 3 months (needed help or ER visit) - 3 months deferral', ar: 'Ø­Ø¯Ø«Øª Ù†ÙˆØ¨Ø© Ø­Ø§Ø¯Ø© Ø®Ù„Ø§Ù„ Ù£ Ø£Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠØ© - ØªØ£Ø¬ÙŠÙ„ Ù£ Ø£Ø´Ù‡Ø±', days: 90, t: 'temporary' },
      { id: 'ok', en: 'Diabetes well controlled, no complications, have eaten in past 2 hours - Eligible', ar: 'Ø§Ù„Ø³ÙƒØ±ÙŠ Ù…Ø¶Ø¨ÙˆØ·ØŒ Ù„Ø§ Ù…Ø¶Ø§Ø¹ÙØ§ØªØŒ Ø£ÙƒÙ„Øª Ù…Ø¤Ø®Ø±Ø§Ù‹ - Ù…Ø¤Ù‡Ù„', days: 0, t: null },
    ],
    pregnancy: [
      { id: 'recent', en: 'Yes, pregnant in past 9 months - 9 months deferral from pregnancy end', ar: 'Ù†Ø¹Ù…ØŒ Ø­Ù…Ù„ Ø®Ù„Ø§Ù„ Ù© Ø£Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠØ© - ØªØ£Ø¬ÙŠÙ„ Ù© Ø£Ø´Ù‡Ø± Ù…Ù† Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø­Ù…Ù„', days: 270, t: 'temporary' },
      { id: 'old', en: 'No, pregnancy was more than 9 months ago - Eligible (TRALI restriction may apply)', ar: 'Ù„Ø§ØŒ Ø§Ù„Ø­Ù…Ù„ ÙƒØ§Ù† Ù‚Ø¨Ù„ Ø£ÙƒØ«Ø± Ù…Ù† Ù© Ø£Ø´Ù‡Ø± - Ù…Ø¤Ù‡Ù„Ø© (Ù‚Ø¯ ØªÙØ·Ø¨Ù‚ Ù‚ÙŠÙˆØ¯ TRALI)', days: 0, t: null },
    ],
    medication: [
      { id: 'taking', en: 'Yes, I am taking a medication from the deferral list', ar: 'Ù†Ø¹Ù…ØŒ Ø£ØªÙ†Ø§ÙˆÙ„ Ø¯ÙˆØ§Ø¡ Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ£Ø¬ÙŠÙ„', days: null, t: 'hold_for_review' },
      { id: 'not_taking', en: 'No, I am not taking any medication from the list', ar: 'Ù„Ø§ØŒ Ù„Ø§ Ø£ØªÙ†Ø§ÙˆÙ„ Ø£ÙŠ Ø¯ÙˆØ§Ø¡ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©', days: 0, t: null },
    ],
    vaccine: [
      { id: '4w', en: 'Live attenuated: Rubella, Varicella - 4 weeks deferral', ar: 'Ø­ÙŠØ© Ù…Ø¶Ø¹ÙØ©: Ø§Ù„Ø­ØµØ¨Ø© Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠØ©ØŒ Ø¬Ø¯Ø±ÙŠ Ø§Ù„Ù…Ø§Ø¡ - Ù¤ Ø£Ø³Ø§Ø¨ÙŠØ¹', days: 28, t: 'temporary' },
      { id: '2w', en: 'Live attenuated: Measles, Mumps, Oral Polio, Yellow fever - 2 weeks deferral', ar: 'Ø­ÙŠØ© Ù…Ø¶Ø¹ÙØ©: Ø§Ù„Ø­ØµØ¨Ø©ØŒ Ø§Ù„Ù†ÙƒØ§ÙØŒ Ø´Ù„Ù„ Ø§Ù„Ø£Ø·ÙØ§Ù„ - Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†', days: 14, t: 'temporary' },
      { id: 'covid', en: 'COVID-19 live attenuated - 14 days deferral', ar: 'ÙƒÙˆÙÙŠØ¯-Ù¡Ù© Ø­ÙŠ Ù…Ø¶Ø¹Ù - Ù¡Ù¤ ÙŠÙˆÙ…Ø§Ù‹', days: 14, t: 'temporary' },
      { id: 'none', en: 'Jynneos, COVID-19 mRNA, Killed vaccines, Recombinant, Intranasal flu - No deferral if symptom-free', ar: 'Ø¬Ø§ÙŠÙ†ÙŠÙˆØ³ØŒ ÙƒÙˆÙÙŠØ¯ mRNAØŒ Ù„Ù‚Ø§Ø­Ø§Øª Ù…ÙŠØªØ©ØŒ Ù…Ø¤ØªÙ„ÙØ© - Ø¨Ø¯ÙˆÙ† ØªØ£Ø¬ÙŠÙ„', days: 0, t: null },
    ],
    smallpox: [
      { id: 'jynneos', en: 'Contact was vaccinated with Jynneos (non-replicating) - No deferral', ar: 'Ø§Ù„Ø´Ø®Øµ ØªÙ„Ù‚Ù‰ Ù„Ù‚Ø§Ø­ Ø¬Ø§ÙŠÙ†ÙŠÙˆØ³ (ØºÙŠØ± Ù…ØªÙƒØ§Ø«Ø±) - Ø¨Ø¯ÙˆÙ† ØªØ£Ø¬ÙŠÙ„', days: 0, t: null },
      { id: 'no_contact', en: 'Other vaccine but NO contact with vaccination site or bandages - No deferral', ar: 'Ù„Ù‚Ø§Ø­ Ø¢Ø®Ø± Ù„ÙƒÙ† Ù„Ø§ Ù…Ù„Ø§Ù…Ø³Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø£Ùˆ Ø§Ù„Ø¶Ù…Ø§Ø¯Ø§Øª - Ø¨Ø¯ÙˆÙ† ØªØ£Ø¬ÙŠÙ„', days: 0, t: null },
      { id: 'complications', en: 'Had contact with vaccination site/bandages OR developed complications - 8 weeks deferral', ar: 'Ù„Ø§Ù…Ø³Øª Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØªØ·Ø¹ÙŠÙ…/Ø§Ù„Ø¶Ù…Ø§Ø¯Ø§Øª Ø£Ùˆ Ø¸Ù‡Ø±Øª Ù…Ø¶Ø§Ø¹ÙØ§Øª - Ù¨ Ø£Ø³Ø§Ø¨ÙŠØ¹', days: 56, t: 'temporary' },
    ],
    malaria: [
      { id: 'short', en: 'Stay was â‰¤24 hours in endemic area - Eligible', ar: 'Ø§Ù„Ø¥Ù‚Ø§Ù…Ø© ÙƒØ§Ù†Øª â‰¤Ù¢Ù¤ Ø³Ø§Ø¹Ø© ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…ÙˆØ¨ÙˆØ¡Ø© - Ù…Ø¤Ù‡Ù„', days: 0, t: null },
      { id: 'traveler', en: 'Traveler (not resident), stayed >24 hours in endemic area - 3 months deferral', ar: 'Ù…Ø³Ø§ÙØ± (Ù„ÙŠØ³ Ù…Ù‚ÙŠÙ…Ø§Ù‹)ØŒ Ø£Ù‚Ø§Ù… >Ù¢Ù¤ Ø³Ø§Ø¹Ø© - ØªØ£Ø¬ÙŠÙ„ Ù£ Ø£Ø´Ù‡Ø±', days: 90, t: 'temporary' },
      { id: 'resident', en: 'Resident of endemic country (>5 years) - 3 years deferral from departure', ar: 'Ù…Ù‚ÙŠÙ… ÙÙŠ Ø¯ÙˆÙ„Ø© Ù…ÙˆØ¨ÙˆØ¡Ø© (>Ù¥ Ø³Ù†ÙˆØ§Øª) - ØªØ£Ø¬ÙŠÙ„ Ù£ Ø³Ù†ÙˆØ§Øª Ù…Ù† Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©', days: 1095, t: 'temporary' },
    ],
    blood_contact: [
      { id: 'open_wound', en: 'Contact with open wound/non-intact skin/mucous membrane with blood - 6 months deferral', ar: 'ØªÙ„Ø§Ù…Ø³ Ù…Ø¹ Ø¬Ø±Ø­ Ù…ÙØªÙˆØ­/Ø¬Ù„Ø¯ ØºÙŠØ± Ø³Ù„ÙŠÙ…/Ø£ØºØ´ÙŠØ© Ù…Ø®Ø§Ø·ÙŠØ© Ù…Ø¹ Ø§Ù„Ø¯Ù… - ØªØ£Ø¬ÙŠÙ„ Ù¦ Ø£Ø´Ù‡Ø±', days: 180, t: 'temporary' },
      { id: 'needlestick', en: 'Needle-stick/sharps injury from instrument used on another person - 6 months deferral', ar: 'ÙˆØ®Ø² Ø¥Ø¨Ø±Ø©/Ø¥ØµØ§Ø¨Ø© Ø¨Ø£Ø¯ÙˆØ§Øª Ø­Ø§Ø¯Ø© Ø§Ø³ØªØ®Ø¯Ù…Øª Ø¹Ù„Ù‰ Ø´Ø®Øµ Ø¢Ø®Ø± - ØªØ£Ø¬ÙŠÙ„ Ù¦ Ø£Ø´Ù‡Ø±', days: 180, t: 'temporary' },
      { id: 'intact_skin', en: 'Contact with intact skin only (no open wounds/cuts) - No deferral', ar: 'ØªÙ„Ø§Ù…Ø³ Ù…Ø¹ Ø¬Ù„Ø¯ Ø³Ù„ÙŠÙ… ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† Ø¬Ø±ÙˆØ­ Ù…ÙØªÙˆØ­Ø©) - Ø¨Ø¯ÙˆÙ† ØªØ£Ø¬ÙŠÙ„', days: 0, t: null },
    ],
  };

  // Travel followup with form
  if (type === 'travel') return (
    <div className="space-y-4">
      <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
        <div className="bg-red-50 px-6 py-3 border-b border-red-100 flex items-center justify-between">
          <div>
            <span className="text-lg font-bold text-red-700">{q.id}</span>
            <span className="text-red-400 mx-2">â€¢</span>
            <span className="text-red-600 text-sm">{language === 'en' ? 'Follow-up' : 'Ù…ØªØ§Ø¨Ø¹Ø©'}</span>
          </div>
        </div>
        <div className="p-6 space-y-4">
          <div className="bg-blue-50 border border-blue-200 rounded-xl p-4">
            <p className="text-sm text-blue-800 font-medium mb-3">
              {language === 'en' 
                ? 'Please provide your travel details. Staff will check for disease outbreaks and endemic areas.' 
                : 'ÙŠØ±Ø¬Ù‰ ØªÙ‚Ø¯ÙŠÙ… ØªÙØ§ØµÙŠÙ„ Ø³ÙØ±Ùƒ. Ø³ÙŠØªØ­Ù‚Ù‚ Ø§Ù„Ù…ÙˆØ¸ÙÙˆÙ† Ù…Ù† Ø§Ù„Ø£ÙˆØ¨Ø¦Ø© ÙˆØ§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ÙˆØ¨ÙˆØ¡Ø©.'}
            </p>
            <div className="space-y-1 text-sm">
              <ExtLink href={REFERENCE_LINKS.pha.url}>
                {language === 'en' ? REFERENCE_LINKS.pha.name : REFERENCE_LINKS.pha.nameAr}
              </ExtLink>
              <br />
              <ExtLink href={REFERENCE_LINKS.moh.url}>
                {language === 'en' ? REFERENCE_LINKS.moh.name : REFERENCE_LINKS.moh.nameAr}
              </ExtLink>
            </div>
          </div>
          
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              {language === 'en' ? 'Where did you travel? (Country/Region)' : 'Ø£ÙŠÙ† Ø³Ø§ÙØ±ØªØŸ (Ø§Ù„Ø¯ÙˆÙ„Ø©/Ø§Ù„Ù…Ù†Ø·Ù‚Ø©)'}
            </label>
            <input 
              type="text" 
              value={travelInfo.dest} 
              onChange={e => setTravelInfo(p => ({ ...p, dest: e.target.value }))} 
              className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent" 
              placeholder={language === 'en' ? 'e.g., Egypt, UAE, India' : 'Ù…Ø«Ø§Ù„: Ù…ØµØ±ØŒ Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªØŒ Ø§Ù„Ù‡Ù†Ø¯'} 
            />
          </div>
          
          <div>
            <label className="block text-sm font-medium text-gray-700 mb-2">
              {language === 'en' ? 'When did you return?' : 'Ù…ØªÙ‰ Ø¹Ø¯ØªØŸ'}
            </label>
            <input 
              type="date" 
              value={travelInfo.date} 
              onChange={e => setTravelInfo(p => ({ ...p, date: e.target.value }))} 
              className="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent" 
            />
          </div>

          <button 
            onClick={() => onSelect('hold_for_review', null, `Travel to ${travelInfo.dest} - requires outbreak/endemic check`)} 
            disabled={!travelInfo.dest || !travelInfo.date}
            className={`w-full py-4 rounded-xl font-semibold text-white transition-all ${
              travelInfo.dest && travelInfo.date 
                ? 'bg-gradient-to-r from-red-600 to-rose-500 hover:from-red-700 hover:to-rose-600' 
                : 'bg-gray-300 cursor-not-allowed'
            }`}
          >
            {language === 'en' ? 'Continue' : 'Ù…ØªØ§Ø¨Ø¹Ø©'}
          </button>
        </div>
      </div>
      
      <button 
        onClick={onBack}
        className="w-full py-3 rounded-xl border border-gray-200 text-gray-600 font-medium hover:bg-gray-50 transition-all flex items-center justify-center gap-2"
      >
        <ChevronLeft className="w-4 h-4" />
        {language === 'en' ? 'Back to Question' : 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø³Ø¤Ø§Ù„'}
      </button>
    </div>
  );

  // Standard options followup
  const opts = options[type] || [];
  return (
    <div className="space-y-4">
      <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
        <div className="bg-red-50 px-6 py-3 border-b border-red-100">
          <span className="text-lg font-bold text-red-700">{q.id}</span>
          <span className="text-red-400 mx-2">â€¢</span>
          <span className="text-red-600 text-sm">{language === 'en' ? 'Follow-up' : 'Ù…ØªØ§Ø¨Ø¹Ø©'}</span>
        </div>
        <div className="p-6 space-y-3">
          <h3 className="text-lg font-semibold text-gray-800 mb-4" dir={language === 'ar' ? 'rtl' : 'ltr'}>
            {language === 'en' ? q.en : q.ar}
          </h3>
          
          {/* Malaria reference link */}
          {type === 'malaria' && (
            <div className="mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
              <ExtLink href={REFERENCE_LINKS.cdc_malaria.url} className="text-sm">
                {language === 'en' ? 'Check CDC Malaria Endemic Areas Map' : 'ØªØ­Ù‚Ù‚ Ù…Ù† Ø®Ø±ÙŠØ·Ø© Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ù„Ø§Ø±ÙŠØ§'}
              </ExtLink>
            </div>
          )}
          
          {opts.map(opt => (
            <button 
              key={opt.id} 
              onClick={() => onSelect(opt.t, opt.days, language === 'en' ? opt.en : opt.ar)}
              className="w-full text-left p-4 rounded-xl border-2 border-gray-200 hover:border-red-300 hover:bg-red-50/50 transition-all"
            >
              <span className="text-gray-800" dir={language === 'ar' ? 'rtl' : 'ltr'}>
                {language === 'en' ? opt.en : opt.ar}
              </span>
            </button>
          ))}
        </div>
      </div>
      
      <button 
        onClick={onBack}
        className="w-full py-3 rounded-xl border border-gray-200 text-gray-600 font-medium hover:bg-gray-50 transition-all flex items-center justify-center gap-2"
      >
        <ChevronLeft className="w-4 h-4" />
        {language === 'en' ? 'Back to Question' : 'Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø³Ø¤Ø§Ù„'}
      </button>
    </div>
  );
}

function ResultScreen({ result, language, onReset }) {
  const config = {
    ELIGIBLE: { icon: Check, bg: 'bg-green-500', title: { en: 'Eligible to Donate', ar: 'Ù…Ø¤Ù‡Ù„ Ù„Ù„ØªØ¨Ø±Ø¹' }, desc: { en: 'You meet all eligibility criteria', ar: 'ØªØ³ØªÙˆÙÙŠ Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø£Ù‡Ù„ÙŠØ©' } },
    TEMPORARILY_DEFERRED: { icon: Clock, bg: 'bg-orange-500', title: { en: 'Temporarily Deferred', ar: 'Ù…Ø¤Ø¬Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹' }, desc: { en: 'You are temporarily unable to donate', ar: 'ØºÙŠØ± Ù‚Ø§Ø¯Ø± Ù…Ø¤Ù‚ØªØ§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªØ¨Ø±Ø¹' } },
    INDEFINITELY_DEFERRED: { icon: Clock, bg: 'bg-red-400', title: { en: 'Indefinitely Deferred', ar: 'Ù…Ø¤Ø¬Ù„ Ù„Ø£Ø¬Ù„ ØºÙŠØ± Ù…Ø³Ù…Ù‰' }, desc: { en: 'Deferred until condition resolves', ar: 'Ù…Ø¤Ø¬Ù„ Ø­ØªÙ‰ ÙŠØªÙ… Ø­Ù„ Ø§Ù„Ø­Ø§Ù„Ø©' } },
    PERMANENTLY_DEFERRED: { icon: X, bg: 'bg-red-600', title: { en: 'Permanently Deferred', ar: 'Ù…Ø¤Ø¬Ù„ Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù…' }, desc: { en: 'Not eligible to donate blood', ar: 'ØºÙŠØ± Ù…Ø¤Ù‡Ù„ Ù„Ù„ØªØ¨Ø±Ø¹ Ø¨Ø§Ù„Ø¯Ù…' } },
    PENDING_REVIEW: { icon: FileText, bg: 'bg-blue-500', title: { en: 'Pending Review', ar: 'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©' }, desc: { en: 'Your eligibility requires staff review', ar: 'ØªØªØ·Ù„Ø¨ Ø£Ù‡Ù„ÙŠØªÙƒ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†' } },
  };
  const c = config[result.status] || config.PENDING_REVIEW;
  const Icon = c.icon;

  return (
    <div className="space-y-6">
      <div className="bg-white rounded-2xl shadow-lg overflow-hidden">
        <div className={`${c.bg} p-8 text-white text-center`}>
          <div className="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4">
            <Icon className="w-10 h-10" />
          </div>
          <h2 className="text-2xl font-bold mb-2">{language === 'en' ? c.title.en : c.title.ar}</h2>
          <p className="text-white/80">{language === 'en' ? c.desc.en : c.desc.ar}</p>
        </div>

        {result.endDate && (
          <div className="p-6 border-b border-gray-100">
            <div className="flex items-center gap-3 mb-3">
              <Calendar className="w-5 h-5 text-gray-500" />
              <span className="font-medium text-gray-700">{language === 'en' ? 'Eligible Again On:' : 'Ù…Ø¤Ù‡Ù„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ÙÙŠ:'}</span>
            </div>
            <div className="bg-gray-50 rounded-xl p-4">
              <p className="text-2xl font-bold text-gray-800">
                {result.endDate.toLocaleDateString(language === 'en' ? 'en-US' : 'ar-SA', { year: 'numeric', month: 'long', day: 'numeric' })}
              </p>
              <p className="text-sm text-gray-500 mt-1">
                {result.daysLeft} {language === 'en' ? 'days from today' : 'ÙŠÙˆÙ…Ø§Ù‹ Ù…Ù† Ø§Ù„ÙŠÙˆÙ…'}
              </p>
            </div>
          </div>
        )}

        {result.deferrals.length > 0 && (
          <div className="p-6">
            <h3 className="font-semibold text-gray-800 mb-4 flex items-center gap-2">
              <Info className="w-5 h-5 text-gray-500" />
              {language === 'en' ? 'Deferral Reasons' : 'Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„ØªØ£Ø¬ÙŠÙ„'}
              <span className="bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full">{result.deferrals.length}</span>
            </h3>
            <div className="space-y-3">
              {result.deferrals.map((d, i) => (
                <div key={i} className={`p-4 rounded-xl border ${d === result.controlling ? 'border-red-300 bg-red-50' : 'border-gray-200 bg-gray-50'}`}>
                  <div className="flex items-center gap-2 mb-1">
                    <span className="text-xs font-medium text-gray-500">{d.question}</span>
                    {d === result.controlling && (
                      <span className="text-xs bg-red-600 text-white px-2 py-0.5 rounded-full">
                        {language === 'en' ? 'Controlling' : 'Ø§Ù„Ù…ØªØ­ÙƒÙ…'}
                      </span>
                    )}
                  </div>
                  <p className="text-sm text-gray-800">{d.reason}</p>
                  <div className="text-xs text-gray-500 mt-1 capitalize">
                    {d.type?.replace(/_/g, ' ')} {d.days ? `â€¢ ${d.days} days` : ''}
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}
      </div>

      <button 
        onClick={onReset} 
        className="w-full py-4 rounded-xl bg-gradient-to-r from-red-600 to-rose-500 text-white font-semibold hover:from-red-700 hover:to-rose-600 transition-all flex items-center justify-center gap-2"
      >
        <RefreshCw className="w-5 h-5" />
        {language === 'en' ? 'Start New Screening' : 'Ø¨Ø¯Ø¡ ÙØ­Øµ Ø¬Ø¯ÙŠØ¯'}
      </button>
    </div>
  );
}

function RulesDatabase({ language, rules, metadata }) {
  const [search, setSearch] = useState('');
  const [category, setCategory] = useState('all');
  const [expanded, setExpanded] = useState(null);

  const categories = useMemo(() => ['all', ...new Set(rules.map(r => r.category).filter(Boolean))].sort(), [rules]);
  
  const filtered = useMemo(() => rules.filter(r => {
    if (category !== 'all' && r.category !== category) return false;
    if (search) {
      const q = search.toLowerCase().trim();
      const qNum = r.question_number || '';
      
      // Check if search looks like a question number (Q followed by number, REQ-, or just a number)
      const isQuestionSearch = /^(q\d+(\.\d+)?|req-?\d+|\d+(\.\d+)?)$/i.test(q);
      
      if (isQuestionSearch) {
        // Extract the search number/pattern
        let searchPattern = q.toUpperCase();
        
        // If just a number like "3", convert to "Q3"
        if (/^\d+$/.test(q)) {
          searchPattern = 'Q' + q;
        }
        // If "q3" format, normalize to "Q3"
        else if (/^q\d/i.test(q)) {
          searchPattern = 'Q' + q.slice(1);
        }
        
        // For exact question number match (e.g., searching "3" or "Q3" should only match "Q3", not "Q13", "Q23", "Q9.3")
        // Check if the rule's question number starts with our pattern followed by a dot or end of string
        const ruleNumUpper = qNum.toUpperCase();
        
        // Exact match: Q3 matches Q3, Q3.1, Q3.2, etc. but NOT Q13, Q23, Q33, Q43
        if (ruleNumUpper === searchPattern) return true;
        if (ruleNumUpper.startsWith(searchPattern + '.')) return true;
        
        // For REQ searches
        if (searchPattern.startsWith('REQ') && ruleNumUpper === searchPattern) return true;
        
        return false;
      }
      
      // For text searches, search in text fields
      return r.question_text_en?.toLowerCase().includes(q) || 
             r.question_text_ar?.includes(search) || 
             r.category?.toLowerCase().includes(q) ||
             r.rationale_en?.toLowerCase().includes(q);
    }
    return true;
  }), [rules, search, category]);

  const grouped = useMemo(() => {
    const g = {};
    filtered.forEach(r => { 
      const c = r.category || 'other'; 
      if (!g[c]) g[c] = []; 
      g[c].push(r); 
    });
    return g;
  }, [filtered]);

  return (
    <div className="space-y-6">
      <div className="bg-white rounded-2xl shadow-lg p-6">
        <div className="flex items-center gap-3 mb-4">
          <Database className="w-6 h-6 text-red-600" />
          <h2 className="text-lg font-bold text-gray-800">{language === 'en' ? 'Rules Database' : 'Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯'}</h2>
          <span className="bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full">{rules.length}</span>
        </div>
        <div className="relative mb-4">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
          <input 
            type="text" 
            value={search} 
            onChange={e => setSearch(e.target.value)} 
            placeholder={language === 'en' ? 'Search by question number, keyword...' : 'Ø§Ù„Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø£Ùˆ ÙƒÙ„Ù…Ø©...'} 
            className="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent" 
          />
        </div>
        <select 
          value={category} 
          onChange={e => setCategory(e.target.value)} 
          className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm"
        >
          {categories.map(c => (
            <option key={c} value={c}>
              {c === 'all' ? (language === 'en' ? 'All Categories' : 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª') : c.replace(/_/g, ' ')}
            </option>
          ))}
        </select>
      </div>

      <p className="text-sm text-gray-500">
        {language === 'en' ? `Showing ${filtered.length} of ${rules.length} rules` : `Ø¹Ø±Ø¶ ${filtered.length} Ù…Ù† ${rules.length} Ù‚Ø§Ø¹Ø¯Ø©`}
      </p>

      {Object.entries(grouped).map(([cat, items]) => (
        <div key={cat} className="bg-white rounded-2xl shadow-lg overflow-hidden">
          <div className="bg-gray-50 px-6 py-3 border-b border-gray-200">
            <h3 className="font-semibold text-gray-700 capitalize flex items-center gap-2">
              <Filter className="w-4 h-4" />
              {cat.replace(/_/g, ' ')} 
              <span className="text-xs bg-gray-200 text-gray-600 px-2 py-0.5 rounded-full">{items.length}</span>
            </h3>
          </div>
          <div className="divide-y divide-gray-100">
            {items.map(r => (
              <div key={r.rule_id} className="p-4 hover:bg-gray-50 transition-colors">
                <button onClick={() => setExpanded(expanded === r.rule_id ? null : r.rule_id)} className="w-full text-left">
                  <div className="flex justify-between items-start">
                    <div className="flex-1">
                      <div className="flex items-center gap-2 mb-1">
                        <span className="font-bold text-red-600">{r.question_number}</span>
                        <span className={`text-xs px-2 py-0.5 rounded-full ${
                          r.deferral_type === 'permanent' ? 'bg-red-100 text-red-700' : 
                          r.deferral_type === 'temporary' ? 'bg-orange-100 text-orange-700' : 
                          'bg-gray-100 text-gray-700'
                        }`}>
                          {r.deferral_type || r.node_type}
                        </span>
                      </div>
                      <p className="text-sm text-gray-800" dir={language === 'ar' ? 'rtl' : 'ltr'}>
                        {language === 'en' ? r.question_text_en : r.question_text_ar}
                      </p>
                    </div>
                    <ChevronRight className={`w-5 h-5 text-gray-400 transition-transform flex-shrink-0 ml-2 ${expanded === r.rule_id ? 'rotate-90' : ''}`} />
                  </div>
                </button>
                {expanded === r.rule_id && (
                  <div className="mt-4 pt-4 border-t border-gray-100 space-y-3 text-sm">
                    <div className="grid grid-cols-2 gap-2">
                      <div><span className="text-gray-500">Rule ID:</span> <span className="font-mono">{r.rule_id}</span></div>
                      <div><span className="text-gray-500">Applies to:</span> <span className="capitalize">{r.applies_to}</span></div>
                      {r.deferral_duration && (
                        <div><span className="text-gray-500">Duration:</span> {r.deferral_duration} {r.deferral_unit}</div>
                      )}
                      {r.deferral_duration_days && (
                        <div><span className="text-gray-500">Days:</span> {r.deferral_duration_days}</div>
                      )}
                    </div>
                    <div className="bg-gray-50 rounded-lg p-3">
                      <p className="text-xs text-gray-500 mb-2">Outcomes:</p>
                      <div className="grid grid-cols-2 gap-2 text-xs">
                        <div className="bg-green-50 rounded p-2">
                          <span className="text-green-700 font-medium">YES â†’</span> {r.outcome_if_yes}
                        </div>
                        <div className="bg-red-50 rounded p-2">
                          <span className="text-red-700 font-medium">NO â†’</span> {r.outcome_if_no || '-'}
                        </div>
                      </div>
                    </div>
                    {r.rationale_en && (
                      <p><span className="text-gray-500">Rationale:</span> {r.rationale_en}</p>
                    )}
                    {r.trali_note && (
                      <div className="bg-yellow-50 rounded-lg p-3 text-yellow-800 text-xs">
                        <span className="font-medium">âš ï¸ TRALI Note:</span> {r.trali_note}
                      </div>
                    )}
                    {r.definition_note && (
                      <div className="bg-blue-50 rounded-lg p-3 text-blue-800 text-xs">
                        <span className="font-medium">â„¹ï¸ Definition:</span> {r.definition_note}
                      </div>
                    )}
                    {r.reference_urls && (
                      <div className="bg-indigo-50 rounded-lg p-3">
                        <p className="text-xs text-indigo-700 font-medium mb-2">ğŸ”— Reference Links:</p>
                        <div className="space-y-1">
                          {r.reference_urls.urls ? (
                            r.reference_urls.urls.map((ref, i) => (
                              <a key={i} href={ref.url} target="_blank" rel="noopener noreferrer" 
                                className="flex items-center gap-2 text-xs text-indigo-600 hover:text-indigo-800 hover:underline">
                                <ExternalLink className="w-3 h-3" />
                                {ref.source}
                              </a>
                            ))
                          ) : r.reference_urls.url ? (
                            <a href={r.reference_urls.url} target="_blank" rel="noopener noreferrer" 
                              className="flex items-center gap-2 text-xs text-indigo-600 hover:text-indigo-800 hover:underline">
                              <ExternalLink className="w-3 h-3" />
                              {r.reference_urls.source}
                            </a>
                          ) : null}
                        </div>
                      </div>
                    )}
                    {r.question_number === 'Q13' && (
                      <div className="mt-3">
                        <MedicationList language={language} />
                      </div>
                    )}
                    {r.question_number === 'Q14' && (
                      <div className="mt-3">
                        <VaccineList language={language} />
                      </div>
                    )}
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      ))}

      {filtered.length === 0 && (
        <div className="bg-white rounded-2xl shadow-lg p-12 text-center">
          <Search className="w-12 h-12 text-gray-300 mx-auto mb-4" />
          <p className="text-gray-600">{language === 'en' ? 'No rules found' : 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‚ÙˆØ§Ø¹Ø¯'}</p>
        </div>
      )}

      <div className="bg-gray-50 rounded-xl p-4 text-sm text-gray-500 text-center">
        Version {metadata.version} â€¢ {metadata.total_rules} rules
      </div>
    </div>
  );
}


const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<BloodDonorApp />);
</script>
</body>
</html>